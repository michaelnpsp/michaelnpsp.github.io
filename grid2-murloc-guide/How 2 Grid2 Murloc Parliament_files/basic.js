var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

WH.Types=new function(){this.NPC=1;this.OBJECT=2;this.ITEM=3;this.ITEM_SET=4;this.QUEST=5;this.SPELL=6;this.ZONE=7;this.FACTION=8;this.PET=9;this.ACHIEVEMENT=10;this.TITLE=11;this.EVENT=12;this.CLASS=13;this.RACE=14;this.SKILL=15;this.CURRENCY=17;this.PROJECT=18;this.SOUND=19;this.BUILDING=20;this.FOLLOWER=21;this.MISSION_ABILITY=22;this.MISSION=23;this.SHIP=25;this.THREAT=26;this.RESOURCE=27;this.CHAMPION=28;this.ICON=29;this.ORDER_ADVANCEMENT=30;this.FOLLOWER_A=31;this.FOLLOWER_H=32;this.SHIP_A=33;this.SHIP_H=34;this.CHAMPION_A=35;this.CHAMPION_H=36;this.TRANSMOG_ITEM=37;this.BFA_CHAMPION=38;this.BFA_CHAMPION_A=39;this.AFFIX=40;this.BFA_CHAMPION_H=41;this.AZERITE_ESSENCE_POWER=42;this.AZERITE_ESSENCE=43;this.STORYLINE=44;this.PET_ABILITY=200;this.GUIDE=100;this.TRANSMOG_SET=101;this.OUTFIT=110;this.GEAR_SET=111;var b=[this.NPC,this.OBJECT,this.ITEM,this.ITEM_SET,this.QUEST,this.SPELL,this.ZONE,this.FACTION,this.PET,this.CLASS,this.RACE,this.SKILL,this.SOUND,this.RESOURCE,this.ICON,this.GUIDE,this.TRANSMOG_SET,this.OUTFIT];var a=[this.GEAR_SET];this.inClassic=function(c){return b.indexOf(c)!==-1};this.classicOnly=function(c){return a.indexOf(c)!==-1}};WH.dataEnv={MAIN:1,PTR:2,BETA:3,CLASSIC:4};WH.dataEnvTerm={1:"live",2:"ptr",3:"beta",4:"classic"};WH.dataTree={RETAIL:1,CLASSIC:4};WH.dataTreeTerm={1:"live",4:"classic"};WH.dataEnvToTree={};WH.dataEnvToTree[WH.dataEnv.MAIN]=WH.dataTree.RETAIL;WH.dataEnvToTree[WH.dataEnv.PTR]=WH.dataTree.RETAIL;WH.dataEnvToTree[WH.dataEnv.BETA]=WH.dataTree.RETAIL;WH.dataEnvToTree[WH.dataEnv.CLASSIC]=WH.dataTree.CLASSIC;WH.dataTreeToRoot={};WH.dataTreeToRoot[WH.dataTree.RETAIL]=WH.dataEnv.MAIN;WH.dataTreeToRoot[WH.dataTree.CLASSIC]=WH.dataEnv.CLASSIC;WH.BETA_DOMAIN="shadowlands";if(WH.staticUrl===undefined){WH.staticUrl="https://web.archive.org/web/20200311010648/https://wow.zamimg.com"}if(!Function.prototype.bind){Function.prototype.bind=function(){var a=this,c=Array.prototype.slice.call(arguments),b=c.shift();return function(){return a.apply(b,c.concat(Array.prototype.slice.call(arguments)))}}}if(!String.prototype.ltrim){String.prototype.ltrim=function(){return this.replace(/^\s*/,"")}}if(!String.prototype.rtrim){String.prototype.rtrim=function(){return this.replace(/\s*$/,"")}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/(^\s*|\s*$)/g,"")}}if(!String.prototype.repeat){String.prototype.repeat=function(a){if(this==null){throw new TypeError("can't convert "+this+" to object")}var c=""+this;a=+a;if(a!=a){a=0}if(a<0){throw new RangeError("repeat count must be non-negative")}if(a==Infinity){throw new RangeError("repeat count must be less than infinity")}a=Math.floor(a);if(c.length==0||a==0){return""}if(c.length*a>=1<<28){throw new RangeError("repeat count must not overflow maximum string size")}var b=c.length*a;a=Math.floor(Math.log(a)/Math.log(2));while(a){c+=c;a--}c+=c.substring(0,b-c.length);return c}}if(Element.prototype.getAttributeNames==undefined){Element.prototype.getAttributeNames=function(){var b=this.attributes;var d=b.length;var a=new Array(d);for(var c=0;c<d;c++){a[c]=b[c].name}return a}}if(!Math.sign){Math.sign=function(a){return((a>0)-(a<0))||+a}}WH.error=function(a){if(typeof console!=="undefined"&&typeof console.error==="function"){console.error.apply(console.error,Array.prototype.slice.call(arguments));if(!a){console.error("The error message was empty, and thus will not be logged.");return}}if(WH.Track){WH.Track.nonInteractiveEvent.apply(WH.Track,["Error"].concat(Array.prototype.slice.call(arguments)))}};WH.info=function(a){if(typeof console!=="undefined"&&typeof console.info==="function"){console.info.apply(console.info,Array.prototype.slice.call(arguments))}};WH.log=function(a){if(typeof console!=="undefined"&&typeof console.log==="function"){console.log.apply(console.log,Array.prototype.slice.call(arguments))}};WH.warn=function(a){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn.apply(console.warn,Array.prototype.slice.call(arguments))}};WH.isArray=function(a){return a instanceof Array};WH.isBool=function(a){return typeof a==="boolean"};WH.isNull=function(a){return a===null};WH.isNumber=function(a){return typeof a==="number"};WH.isObject=function(a){return typeof a==="object"&&a!==null&&!(a instanceof Array)};WH.isString=function(a){return typeof a==="string"};WH.data.get=function(b){var a=WH.data;b=Array.prototype.slice.call(arguments);while(b.length){if(a[b[0]]){a=a[b.shift()]}else{return null}}return a};WH.data.set=function(a,b){return WH.setValueOnObject(WH.data,a,b)};WH.getScriptData=function(b){var a=WH.ge("data."+b);if(a){return JSON.parse(a.innerHTML)}};WH.setValueOnObject=function(b,d,e,f){if(typeof d==="number"||typeof d==="string"){b[d]=e;return true}if(!(d instanceof Array)){WH.error("Invalid key type passed to WH.setValueOnObject:",typeof d,b,d,e);return false}if(d.length<1){WH.error("WH.setValueOnObject called with an empty key list:",b,d,e);return false}while(d.length>1){var a=d.shift();if(typeof b[a]==="undefined"){b[a]={}}if(typeof b[a]!=="object"){WH.error("Dead end while setting value on object.",b,d,e);return false}b=b[a]}if(f){var c=d.shift();if(typeof b[c]==="undefined"){b[c]=e}}else{b[d.shift()]=e}return true};WH.normalizeEvent=function(a){if(!a){if(typeof window.event!="undefined"){a=window.event}else{return null}}if(a.which){a._button=a.which}else{a._button=a.button+1}a._target=a.target||a.srcElement;a._wheelDelta=a.wheelDelta||-a.detail;return a};WH.stringCompare=function(d,c){if(d==c){return 0}if(d==null){return -1}if(c==null){return 1}var f=parseFloat(d);var e=parseFloat(c);if(!isNaN(f)&&!isNaN(e)&&f!=e){return f<e?-1:1}if(typeof d=="string"&&typeof c=="string"){return d.localeCompare(c)}return d<c?-1:1};WH.trim=function(a){return a.replace(/(^\s*|\s*$)/g,"")};WH.rtrim=function(b,c){var a=b.length;while(--a>0&&b.charAt(a)==c){}b=b.substring(0,a+1);if(b==c){b=""}return b};WH.sprintf=function(c){for(var b=1,a=arguments.length;b<a;++b){c=c.replace("$"+b,arguments[b])}return c};WH.sprintfGlobal=function(c){for(var b=1,a=arguments.length;b<a;++b){c=c.replace(new RegExp("\\$"+b,"g"),arguments[b])}return c};WH.stringReplace=function(c,b,a){while(c.indexOf(b)!=-1){c=c.replace(b,a)}return c};WH.htmlEntities=function(a){return a.replace(/[\u00A0-\u9999<>\&]/gim,function(b){return"&#"+b.charCodeAt(0)+";"})};WH.urlEncode=function(a){a=encodeURIComponent(a);a=WH.stringReplace(a,"+","%2B");return a};WH.urlEncodeHref=function(a){a=encodeURIComponent(a);a=WH.stringReplace(a,"%20","+");a=WH.stringReplace(a,"%3D","=");return a};WH.numberFormat=function(b){var c=(""+parseFloat(b)).split(".");b=c[0];var a=c.length>1?"."+c[1]:"";if(b.length<=3){return b+a}return WH.numberFormat(b.substr(0,b.length-3))+","+b.substr(b.length-3)+a};WH.numberLocaleFormat=function(d,b){var c="";if(typeof b=="number"){c=Locale.locales[b].name}else{if(typeof b=="string"){c=b}else{c=Locale.getName()}}if(c.length==4){c=c.substr(0,2).toLowerCase()+"-"+c.substr(2).toUpperCase()}var a=""+d;try{a=d.toLocaleString(c)}catch(f){a=d.toLocaleString()}return a};WH.inArray=function(f,g,b,e){if(f==null){return -1}if(!WH.isArray(f)){WH.error("Tried looking for a value in a haystack which is not an array.",arguments);return -1}var a;if(b){a=f.length;for(var d=e||0;d<a;++d){if(b(f[d])==g){return d}}return -1}a=f.indexOf(g,e);if(a>=0){return a}a=f.length;for(var c=e||0;c<a;++c){if(f[c]==g){return c}}return -1};WH.isSet=function(a){return typeof window[a]!=="undefined"};if(!WH.isSet("console")){var console={log:function(){}}}WH.arrayWalk=function(f,e,c){for(var d=0,b=f.length;d<b;++d){var a=e(f[d],c,f,d);if(a!=null){f[d]=a}}};WH.arrayApply=function(e,d,b){for(var c=0,a=e.length;c<a;++c){d(e[c],b,e,c)}};WH.arrayFilter=function(e,d){var b=[];for(var c=0,a=e.length;c<a;++c){if(d(e[c])){b.push(e[c])}}return b};WH.arrayUnique=function(e){var b={};for(var c=e.length-1;c>=0;--c){b[e[c]]=1}var a=[];for(var d in b){a.push(d)}return a};WH.closest=function(b,a){while(b&&b.nodeType===Node.ELEMENT_NODE){if(b.matches(a)){return b}b=b.parentNode}return undefined};WH.ge=function(a){if(typeof a!="string"){return a}return document.getElementById(a)};WH.gE=function(b,a){return b.getElementsByTagName(a)};WH.qs=function(a,b){return(b||document).querySelector(a)};WH.qsa=function(a,b){return(b||document).querySelectorAll(a)};WH.ce=function(a,b,c){};WH.ce=(function(a){return function(b,d,e){var c=a(b);if(d){WH.cOr(c,d)}if(e){WH.ae(c,e)}return c}})(typeof document.createElementOriginal==="function"?document.createElementOriginal.bind(document):document.createElement.bind(document));WH.de=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b)}if(b&&b.parentNode){b.parentNode.removeChild(b)}};WH.ae=function(a,b){if(WH.isArray(b)){WH.arrayApply(b,a.appendChild.bind(a));return b}else{return a.appendChild(b)}};WH.aef=function(a,b){return a.insertBefore(b,a.firstChild)};WH.ee=function(b,a){if(!a){a=0}while(b.childNodes[a]){b.removeChild(b.childNodes[a])}};WH.ct=function(a){return document.createTextNode(a)};WH.st=function(a,b){if(a.firstChild&&a.firstChild.nodeType==3){a.firstChild.nodeValue=b}else{WH.aef(a,WH.ct(b))}};WH.noWrap=function(a){a.style.whiteSpace="nowrap"};WH.rf=function(){return false};WH.rfWithoutControlKey=function(a){a=WH.normalizeEvent(a);if(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey){return}return false};WH.aE=function(b,a,c){if(typeof b==="string"){b=document.querySelector(b);if(!b){return}}if(b.addEventListener){b.addEventListener(a,c,false)}else{if(b.attachEvent){b.attachEvent("on"+a,c)}}};WH.dE=function(b,a,c){if(b.removeEventListener){b.removeEventListener(a,c,false)}else{if(b.detachEvent){b.detachEvent("on"+a,c)}}};WH.sp=function(a){if(!a){a=window.event}a.stopPropagation()};WH.setCookie=function(b,g,e,f,d){var a=new Date();var c=b+"="+encodeURI(e)+"; ";a.setDate(a.getDate()+g);c+="expires="+a.toUTCString()+"; ";if(f){c+="path="+f+"; "}if(d){c+="domain="+d+"; "}document.cookie=c;WH.getCookies(b);WH.getCookies.C[b]=e};WH.deleteCookie=function(a){WH.setCookie(a,-1);WH.getCookies.C[a]=null};WH.getCookies=function(b){if(WH.getCookies.I==null){var e=decodeURI(document.cookie).split("; ");WH.getCookies.C={};for(var c=0,a=e.length;c<a;++c){var g=e[c].indexOf("="),f,d;if(g!=-1){f=e[c].substr(0,g);d=e[c].substr(g+1)}else{f=e[c];d=""}WH.getCookies.C[f]=d}WH.getCookies.I=1}if(!b){return WH.getCookies.C}else{return WH.getCookies.C[b]}};WH.dO=function(a){return WH.cO({},a)};WH.cO=function(c,b){for(var a in b){if(b[a]!==null&&typeof b[a]=="object"&&b[a].length){c[a]=b[a].slice(0)}else{c[a]=b[a]}}return c};WH.cOr=function(d,c,b){for(var a in c){if(b&&(a.substr(0,b.length)==b)){continue}if(c[a]!==null&&typeof c[a]=="object"){if(Array.isArray(c[a])){d[a]=c[a].slice(0)}else{if(!d[a]){d[a]={}}WH.cOr(d[a],c[a],b)}}else{d[a]=c[a]}}return d};WH.fround=function(b){if(Math.fround){return Math.fround(b)}else{if(typeof Float32Array!="undefined"&&Float32Array){var a=new Float32Array(1);a[0]=+b;return a[0]}else{return b}}};WH.displayBlock=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.display="block"};WH.displayDefault=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.removeProperty("display")};WH.displayInline=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.display="inline"};WH.displayNone=function(b,a){if(typeof b==="string"){b=(a||document).querySelector(b);if(!b){return}}b.style.display="none"};WH.Browser={ie:!!(window.attachEvent&&!window.opera),opera:!!window.opera,safari:navigator.userAgent.indexOf("Safari")!=-1,firefox:navigator.userAgent.indexOf("Firefox")!=-1,chrome:navigator.userAgent.indexOf("Chrome")!=-1};WH.getWindowSize=function(){var b=0,a=0;if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}else{if(typeof window.innerWidth=="number"){b=window.innerWidth;a=window.innerHeight}}}return{w:b,h:a}};WH.getScroll=function(){if(typeof window.scrollY!=="number"){return{x:window.pageXOffset,y:window.pageYOffset}}return{x:window.scrollX,y:window.scrollY}};WH.getCursorPos=function(c){var b,d;if(window.innerHeight){b=c.pageX;d=c.pageY}else{var a=WH.getScroll();b=c.clientX+a.x;d=c.clientY+a.y}return{x:b,y:d}};WH.ac=function(b,a){let x=0;let y=0;while(b){let match;if(b.style.transform&&(match=b.style.transform.match(/scale\(([\d.]+)\)/i))){x*=parseFloat(match[1]);y*=parseFloat(match[1])}x+=b.offsetLeft;y+=b.offsetTop;let parent=b.parentNode;while(parent&&parent!==b.offsetParent&&parent.offsetParent){if(parent.scrollLeft||parent.scrollTop){x-=(parent.scrollLeft|0);y-=(parent.scrollTop|0);break}parent=parent.parentNode}b=b.offsetParent}if(WH.isSet("Lightbox")&&Lightbox.isVisible()){a=true}if(a){let scroll=WH.getScroll();x+=scroll.x;y+=scroll.y}let result=[x,y];result.x=x;result.y=y;return result};WH.getOffset=function(a,b){let rect=a.getBoundingClientRect();let offset={left:rect.left,top:rect.top};if(b!==true){let scroll=WH.getScroll();offset.left+=scroll.x;offset.top+=scroll.y}return offset};WH.scrollTo=function(d,a,b){if(typeof d==="string"){var c=document.querySelector(d);if(!c){WH.error("Could not select element to scroll to.",d);return}d=c}if(!d||d.nodeType!==Node.ELEMENT_NODE){WH.error("Invalid target to scroll to.",d);return}d.scrollIntoView({behavior:b===false?"auto":"smooth",block:typeof a==="string"?a:"start"})};WH.isElementFixedPosition=function(a){while(a&&a.nodeType===Node.ELEMENT_NODE){if(getComputedStyle(a).getPropertyValue("position")==="fixed"){return true}a=a.parentNode}return false};WH.createReverseLookupJson=function(c){var a={};for(var b in c){a[c[b]]=b}return a};WH.getLocaleFromDomain=function(a){var c=WH.getLocaleFromDomain.L;if(a&&(typeof a=="string")){var b=a.split(".");return c[b[0]]||0}return 0};WH.getLocaleFromDomain.L={ko:1,fr:2,de:3,cn:4,es:6,ru:7,pt:8,it:9};WH.getDomainFromLocale=function(a){var b;if(WH.getDomainFromLocale.L){b=WH.getDomainFromLocale.L}else{b=WH.getDomainFromLocale.L=WH.createReverseLookupJson(WH.getLocaleFromDomain.L)}return(b[a]?b[a]:"")};WH.getTypeIdFromTypeString=function(a){if(!WH.getTypeIdFromTypeString.lookup[a]){WH.error("No type ID found for type string ["+a+"].");return -1}return WH.getTypeIdFromTypeString.lookup[a]};WH.getTypeIdFromTypeString.lookup={npc:1,object:2,item:3,itemset:4,"item-set":4,quest:5,spell:6,zone:7,faction:8,pet:9,achievement:10,title:11,event:12,statistic:16,currency:17,building:20,follower:21,garrisonability:22,missionability:22,"mission-ability":22,mission:23,ship:25,threat:26,resource:27,champion:28,icon:29,"order-advancement":30,"bfa-champion":38,affix:40,"azerite-essence":43,"azerite-essence-power":42,storyline:WH.Types.STORYLINE,guide:100,"transmog-set":101,outfit:110,petability:200,"pet-ability":200};WH.ajaxIshRequest=function(c,f){var d=document.getElementsByTagName("head")[0];if(c.substr(0,5)=="http:"&&location.protocol=="https:"){if(typeof console!="undefined"&&console){var e="Refused to ajaxish load "+c+" from "+location.href;if(typeof console.log=="function"){console.log(e)}else{if(typeof console.error=="function"){console.error(e)}}WH.Track.nonInteractiveEvent("Error","ajaxIshRequest",c,location.href)}return undefined}if(f){var a=WH.ce("script",{type:"text/javascript",src:c});WH.ae(d,a);return a}var b=WH.getGets();if(b.refresh!=null){if(b.refresh.length){c+=("&refresh="+b.refresh)}else{c+="&refresh"}}if(b.locale!=null){c+="&locale="+b.locale}if(b.ptr!=null){c+="&ptr"}var a=WH.ce("script",{type:"text/javascript",src:c,charset:"utf8"});WH.ae(d,a);return a};WH.xhrJsonRequest=function(a,c){var b=new XMLHttpRequest();b.onload=function(d){var f=d.target.response;switch(d.target.responseType){case"json":break;case"":case"text":try{f=JSON.parse(f)}catch(g){WH.error("Could not parse expected JSON response",d.target);return c()}break;default:WH.error("Unexpected response type from JSON request",d.target);return c()}return c(f)};b.onerror=function(){return c()};b.open("GET",a,true);b.responseType="json";b.send()};WH.getGets=function(){if(WH.getGets.C!=null){return WH.getGets.C}var b=WH.getQueryString();var a=WH.parseQueryString(b);WH.getGets.C=a;return a};WH.visitUrlWithPostData=function(b,d){var c=WH.ce("form");c.action=b;c.method="post";for(var a in d){if(d.hasOwnProperty(a)){var e=WH.ce("input");e.type="hidden";e.name=a;e.value=d[a];WH.ae(c,e)}}WH.ae(document.body,c);c.submit()};WH.getQueryString=function(){var a="";if(location.pathname){a+=location.pathname.substr(1)}if(location.search){if(location.pathname){a+="&"}a+=location.search.substr(1)}return a};WH.parseQueryString=function(e){e=decodeURIComponent(e);var d=e.split("&");var c={};for(var b=0,a=d.length;b<a;++b){WH.splitQueryParam(d[b],c)}return c};WH.splitQueryParam=function(c,d){var e=c.indexOf("=");var a;var b;if(e!=-1){a=c.substr(0,e);b=c.substr(e+1)}else{a=c;b=""}d[a]=b};WH.createRect=function(d,c,b,a){return{l:d,t:c,r:d+b,b:c+a}};WH.intersectRect=function(d,c){return !(d.l>=c.r||c.l>=d.r||d.t>=c.b||c.t>=d.b)};WH.getViewport=function(){var a=$(window);return new Rectangle(a.scrollLeft(),a.scrollTop(),a.width(),a.height())};WH.keyPressIsAlphaNumeric=function(b){var a=document.all?b.keycode:b.which;return((a>47&&a<58)||(a>64&&a<91)||(a>95&&a<112)||a==222||a==0)};WH.isRemote=function(){return !WH.pageVars.wowhead};WH.isDev=function(){return !!WH.pageVars.dev};WH.getDataEnv=function(){return WH.pageVars.hasOwnProperty("dataEnv")?WH.pageVars.dataEnv.env:WH.dataEnv.MAIN};WH.getDataEnvTerm=function(a){return WH.dataEnvTerm[a||WH.getDataEnv()]};WH.getDataTree=function(a){if(a!==undefined){return WH.dataEnvToTree[a]}return WH.pageVars.hasOwnProperty("dataEnv")?WH.pageVars.dataEnv.tree:WH.dataTree.RETAIL};WH.getDataTreeTerm=function(a){if(typeof a==="undefined"){a=WH.getDataTree()}if(a===WH.dataTree.CLASSIC){return"classic"}return"live"};WH.getRootEnv=function(a){return WH.dataTreeToRoot[WH.getDataTree(a||WH.getDataEnv())]};WH.getServerTime=function(){if(!WH.pageVars.serverTime){WH.pageVars.serverTime=new Date()}return WH.pageVars.serverTime};WH.getDataBuild=function(a){return(WH.pageVars.dataBuild&&WH.pageVars.dataBuild[a||WH.getDataEnv()])||"0"};WH.isBeta=function(){return WH.getDataEnv()===WH.dataEnv.BETA};WH.isBetaActive=function(){if(WH.pageVars.hasOwnProperty("dataEnv")){return WH.pageVars.dataEnv.active.beta}return !!WH.wowheadRemote};WH.isClassicTree=function(a){return WH.getDataTree(a)===WH.dataTree.CLASSIC};WH.isPtr=function(){return WH.getDataEnv()===WH.dataEnv.PTR};WH.isPtrActive=function(){if(WH.pageVars.hasOwnProperty("dataEnv")){return WH.pageVars.dataEnv.active.ptr}return !!WH.wowheadRemote};WH.isRetailTree=function(a){return WH.getDataTree(a)===WH.dataTree.RETAIL};WH.suppressExternalDebug=function(){return !!WH.pageVars.suppressExternalDebug};WH.setupFooterMenus=function(){var b={"footer-help-menu":mn_footer_help,"footer-tools-menu":mn_footer_tools,"footer-about-menu":mn_footer_about};for(var c in b){if(!b.hasOwnProperty(c)){continue}var a=$("#"+c);if(a.length){a.addClass("hassubmenu");Menu.add(a.get(0),b[c])}}WH.Cookies.updateIcon()};WH.getScreenshotUrl=function(d,b,c){if(!b){b="normal"}var a=b=="normal"&&typeof c=="string"&&c?"-"+WH.Strings.slug(c,true):"";return WH.staticUrl+"/uploads/screenshots/"+b+"/"+d+a+".jpg"};WH.maxLevel=WH.maxLevel||120;WH.maxSkill=WH.maxSkill||800;WH.convertRatingToPercent=function(a,b,h,g){var c=WH.convertRatingToPercent.RB,d=WH.convertRatingToPercent.LH,e=WH.convertRatingToPercent.LT;if(a<0){a=1}else{if(a>WH.maxLevel){a=WH.maxLevel}}if((b==12||b==13||b==14||b==15)&&a<34){a=34}if((b==28||b==36)&&(g==2||g==6||g==7||g==11)){c[b]/=1.3}if(h<0){h=0}if(e&&e[b]&&(a>=80)&&(a-80<e[b].length)){return h/e[b][a-80]}var f;if(!c||c[b]==null){f=0}else{var j;if(a>80){j=d[a]}else{if(a>70){j=(82/52)*Math.pow((131/63),((a-70)/10))}else{if(a>60){j=(82/(262-3*a))}else{if(a>10){j=((a-8)/52)}else{j=2/52}}}}f=h/c[b]/j}return f};WH.statToRating={11:0,12:1,13:2,14:3,15:4,16:5,17:6,18:7,19:8,20:9,21:10,25:15,26:15,27:15,28:17,29:18,30:19,31:5,32:8,34:15,35:15,36:17,37:23,44:24,49:25,57:26,59:11,60:12,61:13,62:16,63:20,64:21,40:29};WH.statToJson={0:"mana",1:"health",3:"agi",4:"str",5:"int",6:"spi",7:"sta",8:"energy",9:"rage",10:"focus",13:"dodgertng",14:"parryrtng",15:"blockrtng",16:"mlehitrtng",17:"rgdhitrtng",18:"splhitrtng",19:"mlecritstrkrtng",20:"rgdcritstrkrtng",21:"splcritstrkrtng",22:"corruption",23:"corruptionres",24:"_splhitrtng",25:"_mlecritstrkrtng",26:"_rgdcritstrkrtng",27:"_splcritstrkrtng",28:"mlehastertng",29:"rgdhastertng",30:"splhastertng",31:"hitrtng",32:"critstrkrtng",33:"_hitrtng",34:"_critstrkrtng",35:"resirtng",36:"hastertng",37:"exprtng",38:"atkpwr",39:"rgdatkpwr",40:"versatility",41:"splheal",42:"spldmg",43:"manargn",44:"armorpenrtng",45:"splpwr",46:"healthrgn",47:"splpen",49:"mastrtng",50:"armorbonus",51:"firres",52:"frores",53:"holres",54:"shares",55:"natres",56:"arcres",57:"pvppower",58:"amplify",59:"multistrike",60:"readiness",61:"speedbonus",62:"lifesteal",63:"avoidance",64:"sturdiness",66:"cleave",71:"agistrint",72:"agistr",73:"agiint",74:"strint"};WH.jsonToStat={};for(var i in WH.statToJson){WH.jsonToStat[WH.statToJson[i]]=i}WH.individualToGlobalStat={16:31,17:31,18:31,19:32,20:32,21:32,24:33,25:34,26:34,27:34,28:36,29:36,30:36};WH.convertScalingFactor=function(b,g,f,d,j){var a=WH.convertScalingFactor.SV;var c=WH.convertScalingFactor.SD;if(!a||!a[b]){if(g_user.roles&U_GROUP_ADMIN){alert("There are no item scaling values for level "+b)}return(j?{}:0)}var k={},h=a[b],e=c[f];if(!e||!(d>=0&&d<=9)){k.v=h[g]}else{k.n=WH.statToJson[e[d]];k.s=e[d];k.v=Math.floor(h[g]*e[d+10]/10000)}return(j?k:k.v)};g_itemScalingCallbacks=[];WH.effectAverage=function(f,j,e,a){var c=WH.convertScalingSpell.RandPropPoints;var h=f.scalingClass;var d=f.coefficient[a];var g=1;var b=0;if(d!=0&&h!=0){if(f.scalesWithItemLevel){if(h==19){b=c[e][0]}else{if(h==21){b=c[e][2]}else{b=c[e][1]}}}else{b=WH.convertScalingSpell.SV[j][h-1]}if(h==255){g=WH.getCombatRatingMult(e,12)}return d*b*g}return f.effectBasePoints[a]};WH.convertScalingSpell=function(p,d,a,e,q,k){var f=WH.convertScalingSpell.SpellInformation;if(!f||!f[d]){return p}a=a-1;if(p.effects==undefined){p.effects={}}if(!p.effects.hasOwnProperty(a+1)){p.effects[a+1]={}}var m=f[d];var o=0;var c=WH.effectAverage(m,q,k,a);if(m.deltaCoefficient[a]!=0){var j=m.deltaCoefficient[a];var b=Math.ceil(c-(c*j/2));var n=Math.floor(c+(c*j/2));if(e==0){o=(b+n)/2}else{if(e==1){o=b}else{if(e==2){o=n}}}}else{if(m.coefficient[a]!=0){o=c}else{o=m.effectBasePoints[a]}}o=Math.abs(o);var g="avg";switch(parseInt(e)){case 0:case 3:g="avg";break;case 1:g="min";break;case 2:g="max";break;case 4:g="pts";break;default:g="avg"}var l=5;var h=l;if(window.g_pageInfo&&window.g_pageInfo.type==WH.Types.AZERITE_ESSENCE_POWER){h=WH.Wow.Item.INVENTORY_TYPE_NECK}if(m.scalesWithItemLevel&&m.appliesRatingAura&&m.appliesRatingAura[a]){o*=WH.getCombatRatingMult(k,h)}p.effects[a+1][g]=o;return p};WH.getDataSource=function(){if(WH.isSet("g_pageInfo")){switch(g_pageInfo.type){case WH.Types.ITEM:if(WH.isSet("g_items")){return g_items}break;case WH.Types.SPELL:if(WH.isSet("g_spells")){return g_spells}break;case WH.Types.AZERITE_ESSENCE_POWER:if(WH.isSet("g_azeriteEssencePowers")){return g_azeriteEssencePowers}break;case WH.Types.PET_ABILITY:if(WH.isSet("g_petabilities")){return g_petabilities}break}}return[]};WH.setJsonItemLevel=function(s,b,h){if(h&&((h.scalingcategory-11)>0)){var u=h.maxlvlscaling?Math.min(b,h.maxlvlscaling):b;var g=WH.getSpellScalingValue(h.scalingcategory,u);for(var q=1;q<3;++q){var a=h["itemenchspell"+q];var l=h["itemenchtype"+q];var m=WH.statToJson[a];if((l==5)&&s[m]){var j=h["damage"+q];if(j){s[m]=Math.round(g*j)}}}if(h.allstats){for(var t in s){s[t]=Math.round(g*h.damage1)}}}if(!s.scadist||!s.scaflags){return}s.bonuses=s.bonuses||{};var k=s.scaflags&255,d=(s.scaflags>>8)&255,n=(s.scaflags&(1<<16))!=0,f=(s.scaflags&(1<<17))!=0,o=(s.scaflags&(1<<18))!=0,p;switch(k){case 5:case 1:case 7:case 17:p=7;break;case 3:case 12:p=8;break;case 16:case 11:case 14:p=9;break;case 15:p=10;break;case 23:case 21:case 22:case 13:p=11;break;default:p=-1}if(p>=0){for(var q=0;q<10;++q){var e=WH.convertScalingFactor(b,p,s.scadist,q,1);if(e.n){s[e.n]=e.v}s.bonuses[e.s]=e.v}}if(o){s.splpwr=s.bonuses[45]=WH.convertScalingFactor(b,6)}if(n){switch(k){case 3:s.armor=WH.convertScalingFactor(b,11+d);break;case 5:s.armor=WH.convertScalingFactor(b,15+d);break;case 1:s.armor=WH.convertScalingFactor(b,19+d);break;case 7:s.armor=WH.convertScalingFactor(b,23+d);break;case 16:s.armor=WH.convertScalingFactor(b,28);break;case 14:s.armor=WH.convertScalingFactor(b,29);break;default:s.armor=0}}if(f){var c=(s.mledps?"mle":"rgd"),r;switch(k){case 23:case 21:case 22:case 13:s.dps=s[c+"dps"]=WH.convertScalingFactor(b,o?2:0);r=0.3;break;case 17:s.dps=s[c+"dps"]=WH.convertScalingFactor(b,o?3:1);r=0.2;break;case 15:s.dps=s[c+"dps"]=WH.convertScalingFactor(b,d==19?5:4);r=0.3;break;default:s.dps=s[c+"dps"]=0;r=0}s.dmgmin=s[c+"dmgmin"]=Math.floor(s.dps*s.speed*(1-r));s.dmgmax=s[c+"dmgmax"]=Math.floor(s.dps*s.speed*(1+r))}};WH.scaleItemEnchantment=function(h,b){var f=h.enchantment;if(h.scalinginfo&&(h.scalinginfo.scalingcategory-11)>0){var e=f.match(/\d+/g);if(e){var g=parseInt(h.scalinginfo.maxlvlscaling)?Math.min(b,parseInt(h.scalinginfo.maxlvlscaling)):b;var a=WH.getSpellScalingValue(h.scalinginfo.scalingcategory,g);for(var c=0;c<e.length;++c){var d=h.scalinginfo["damage"+(c+1)];if(d){f=f.replace(e[c],Math.round(a*d))}}}}return f};WH.getItemRandPropPointsType=function(a){var b=a.slotbak?a.slotbak:a.slot;switch(b){case 1:case 4:case 5:case 7:case 15:case 17:case 20:case 25:return 0;case 2:case 9:case 11:case 16:return 2;case 3:case 6:case 8:case 10:case 12:return 1;case 13:case 14:case 21:case 22:case 23:return 3;case 26:if(a.subclass==19){return 3}return 0;case 28:return 4;break;default:return -1}};WH.scaleItemLevel=function(m,o){var c=m.level;if(m.scadist){var f=WH.convertScalingFactor.SD;var s=WH.curvePoints;var b=f?f[m.scadist]:null;if(s&&b&&b[22]&&b[22]>0){var u=b[22];var t=o?o:WH.maxLevel;if(b[20]&&t<b[20]){t=b[20]}if(b[21]&&t>b[21]){t=b[21]}var h=s[u];if(h&&h.length>0){var p=-1;for(var e in h){var q=h[e];if(q[1]>=t){p=e;break}}var a=h[p!=-1?p:(h.length-1)];var d=null;var k=0;if(p>0){d=h[p-1];var r=a[1]-d[1];if(r>0){var l=t-d[1];var n=l/r;var j=a[2]-d[2];var g=n*j;k=d[2]+g}}else{k=a[2]}if(k>0){c=Math.round(k)}}}}return c};WH.applyStatModifications=function(aa,o,O,u,ad,h,E){var a={};if(aa.hasOwnProperty("level")){a=WH.dO(aa)}else{WH.cOr(a,aa,"__")}if(ad&&ad.length){var C=false;for(var W=0;W<ad.length;++W){var p=ad[W];if(p>0&&WH.isSet("g_itembonuses")&&g_itembonuses[p]){var F=g_itembonuses[p];for(var V=0;V<F.length;++V){var v=F[V];switch(v[0]){case 11:case 13:if(C===false||v[2]<C){a.scadist=v[1];a.scadistbonus=p;C=v[2]}break;default:break}}}}}a.level=WH.scaleItemLevel(a,h);if(O=="pvp"&&aa.pvpUpgrade){a.level+=aa.pvpUpgrade}if(a.subitems&&a.subitems[o]){for(var ae in a.subitems[o].jsonequip){if(!a.hasOwnProperty(ae)){a[ae]=0}a[ae]+=a.subitems[o].jsonequip[ae]}}if(ad&&ad.length){if(aa.statsInfo){a.statsInfo={};for(var W in aa.statsInfo){a.statsInfo[W]={alloc:parseInt(aa.statsInfo[W].alloc),qty:aa.statsInfo[W].qty,socketMult:aa.statsInfo[W].socketMult}}}var B=[0,0,0,0,2147483647,2147483647,2147483647,2147483647];a.extraStats=[];var k=a.scadistbonus?false:0;for(var W=0;W<ad.length;++W){var p=ad[W];if(p>0&&WH.isSet("g_itembonuses")&&g_itembonuses[p]){var F=g_itembonuses[p];for(var V=0;V<F.length;++V){var v=F[V];switch(v[0]){case 1:if(!a.scadistbonus){a.level+=v[1];k=false}break;case 2:if(a.statsInfo){if(a.statsInfo.hasOwnProperty(v[1])){a.statsInfo[v[1]].alloc+=v[2]}else{a.extraStats.push(v[1]);a.statsInfo[v[1]]={alloc:parseInt(v[2]),qty:0,socketMult:0}}}break;case 3:a.quality=parseInt(v[1]);break;case 4:var e=v[1];var b=v[2];var S=4;var R=4;do{if(b<=B[S]){var t=e;e=B[S-4];B[S-4]=t;var Q=b;b=B[S];B[S]=Q}++S;--R}while(R);break;case 5:if(WH.isSet("g_item_namedescriptions")&&g_item_namedescriptions[v[1]]){a.nameSuffix=g_item_namedescriptions[v[1]][0]}break;case 6:var K=a.nsockets?a.nsockets:0;a.nsockets=K+v[1];for(var T=K;T<(K+v[1]);++T){a["socket"+(T+1)]=v[2]}break;case 7:break;case 8:a.reqlevel+=v[1];break;case 14:if(k!==false){k=a.level}break;default:break}}}}if(k){a.level=k;a.previewLevel=k}if(WH.isSet("g_item_namedescriptions")){a.namedesc=a.namedesc?a.namedesc:"";for(var V=0;V<4;++V){if(B[V]&&g_item_namedescriptions[B[V]]){a.namedesc+=(!a.namedesc?"":" ")+g_item_namedescriptions[B[V]][0];if(!V){a.namedesccolor=g_item_namedescriptions[B[V]][1]}}}}}if(aa.statsInfo&&aa.level&&WH.applyStatModifications.ScalingData){var Y=WH.applyStatModifications.ScalingData.AV,m=WH.applyStatModifications.ScalingData.SV,A=WH.applyStatModifications.ScalingData.AL;a.level=u?u:(O&&aa.upgrades&&aa.upgrades[O-1]?(a.level+aa.upgrades[O-1]):a.level);var s=a.level-aa.level;var M=Math.pow(1.15,s/15);var I=WH.getItemRandPropPointsType(a);var P=[];for(var X=a.level;X>=0;X--){if(m.hasOwnProperty(X)){P=m[X];break}}var r=0;if(I!=-1){var N=0;switch(a.quality){case 5:case 4:N=0;break;case 7:case 3:N=1;break;case 2:N=2;break;default:break}var q=N*5+I;r=P[q]?P[q]:0}var L=P[15];for(var W in WH.statToJson){var g=WH.statToJson[W];if(a[g]||(a.statsInfo&&a.statsInfo[W])){var l=0;var ac=0;if(a.statsInfo.hasOwnProperty(W)){l=parseFloat(a.statsInfo[W].socketMult);ac=parseInt(a.statsInfo[W].alloc)}var z=Math.round(l*L);if(ac&&r>0){a[g]=Math.floor(ac*0.0001*r-z+0.5)}else{a[g]=Math.floor(((a[g]+z)*M)-z)}if(g=="sta"){a[g]=Math.floor(a[g]*WH.getStaminaRatingMult(a.level,a.slot||g_items[a.id].slot))}else{if(E&&WH.inArray(WH.applyStatModifications.BASE_STATS,W)<0){a[g]=Math.floor(a[g]*WH.getCombatRatingMult(a.level,a.slot||g_items[a.id].slot))}else{if(g==="corruption"||g==="corruptionres"){a[g]=ac}}}switch(g){case"agistrint":a.agi=a.str=a["int"]=a[g];break;case"agistr":a.agi=a.str=a[g];break;case"agiint":a.agi=a["int"]=a[g];break;case"strint":a.str=a["int"]=a[g];break;default:break}}}if(a.armor&&Y[a.level]){var D=(a.quality==7)?3:a.quality;var c=(a.subclass==-6)?1:a.subclass;if(WH.inArray([1,2,3,4],c)!=-1){var ab=Y[a.level][11+D];var J=Y[a.level][c-1];var f=A[a.slot][c-1];a.armor=Math.floor(J*ab*f+0.5)}if(a.subclass==6){a.armor=Y[a.level][4+D]}}if(a.dps){var d=["dps","mledps","rgddps"];var U=["dmgmin1","mledmgmin","rgddmgmin","dmgmax1","mledmgmax","rgddmgmax"];var Z=WH.getEffectiveWeaponDamage(a,false);var w=WH.getEffectiveWeaponDamage(a,true);Z=Math.floor(Math.max(1,Z));w=Math.max(1,w);if(WH.isClassicTree()){Z=a.damagemin||Z;w=a.damagemax||w}var H=((Z+w)/2)/a.speed;var G=H>=1000?0:(WH.isClassicTree()?2:1);H=parseFloat(H.toFixed(G));for(var W in d){if(a[d[W]]){a[d[W]]=H}}for(var W in U){if(a[U[W]]){if(U[W].indexOf("max")!=-1){a[U[W]]=w}else{a[U[W]]=Z}}}}}return a};WH.applyStatModifications.BASE_STATS=[4,3,5,71,72,73,74,7,1,0,8,9,2,10];WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL=67;WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL=92;WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL=104;WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL=116;WH.getItemDamageValue=function(c,e,a){var b=WH.applyStatModifications.ScalingData.DV;var d=7*a+e;if(b&&b[c]&&b[c][d]){return b[c][d]}return 0};WH.getEffectiveWeaponDamage=function(j,a){var f=j.level;var c=j.subclass;var h=j.quality;var d=j.slotbak?j.slotbak:j.slot;var g=0;var k=false;var b=j.flags2&512;if(j.classs!=2){return 0}if(h>7){return 0}if(h==7){h=3}if(d>22){if(d==24){g=0;k=true}if(!k&&(d<=24||d>26)){k=true}}else{if(d==21||d==22||d==13){if(!b){g=WH.getItemDamageValue(f,h,0)}else{g=WH.getItemDamageValue(f,h,1)}k=true}if(!k&&d!=15){if(d!=17){k=true}else{if(!b){g=WH.getItemDamageValue(f,h,2)}else{g=WH.getItemDamageValue(f,h,3)}k=true}}}if(!k&&c>=2){if(c==2||c==3||c==18){if(!b){g=WH.getItemDamageValue(f,h,2)}else{g=WH.getItemDamageValue(f,h,3)}k=true}if(!k&&c==19){g=WH.getItemDamageValue(f,h,1)}}if(g>0){var e=j.dmgrange||0;if(!a){return g*j.speed*(1-e/2)}else{return Math.floor((g*j.speed*(1+e/2))+0.5)}}return 0};WH.getJsonReforge=function(c,a){if(!a){if(!WH.reforgeStats){return[]}c.__reforge={};c.__reforge.all=[];for(var a in WH.reforgeStats){var d=WH.getJsonReforge(c,a);if(d.amount){c.__reforge.all.push(d)}}return c.__reforge.all}if(!WH.reforgeStats||!WH.reforgeStats[a]){return{}}c.__statidx={};for(var b in c){if(WH.individualToGlobalStat[WH.jsonToStat[b]]){c.__statidx[WH.individualToGlobalStat[WH.jsonToStat[b]]]=c[b]}else{c.__statidx[WH.jsonToStat[b]]=c[b]}}if(!c.__reforge){c.__reforge={}}var d=c.__reforge[a]=WH.dO(WH.reforgeStats[a]);c.__reforge[a].amount=Math.floor(d.v*(c.__statidx[d.i1]&&!c.__statidx[d.i2]?c.__statidx[d.i1]:0));return c.__reforge[a]};WH.getJsonItemEnchantMask=function(a){if(a.classs==2&&a.subclass==19){return 1<<(21-1)}return 1<<(a.slot-1)};WH.getArtifactKnowledgeMultiplier=function(d){var c=1;for(var b=0,a;a=WH.data.artifactKnowledgeMultiplier[b];b++){if(b>d){break}c=a}return c};WH.getCurveValue=function(c,b){var d;if(!WH.curvePoints||!(d=WH.curvePoints[c])){return undefined}var f=d[0][1];var e=d[0][2];if(f>b){return e}for(var g=0,a;a=d[g];g++){if(b==a[1]){return a[2]}if(b<a[1]){return(a[2]-e)/(a[1]-f)*(b-f)+e}f=a[1];e=a[2]}return e};WH.setItemModifications=function(E,s,O,J,g,u){if(!WH.isSet("g_items")||!g_items[s]||!g_items[s].jsonequip){return E}if(!g){g=WH.maxLevel}O=O?O.split(":"):null;var D=g_items[s].bonusesData;var A=0;var q=O?O.indexOf("u"):-1;if(D&&q!=-1){A=O[q+1];O.splice(q,1)}if(!u){u=0;switch(J){case"twtbc":u=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL;break;case"twwotlk":u=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL;break;case"twcata":u=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL;break;case"twmists":u=WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL;break}}J=!u?J:null;var L=WH.applyStatModifications(g_items[s].jsonequip,0,J,u,O,g);if(!L.name&&g_items[s].hasOwnProperty("name_"+Locale.getName())){L.name=g_items[s]["name_"+Locale.getName()];L.quality=g_items[s].quality}if(A){var o=WH.bonusesBtnGetContextBonusId(O);var w=D[o].sub[A].sub;for(var n in w){var k=WH.applyStatModifications(g_items[s].jsonequip,0,J,u,[o,n]);for(var d in k.statsInfo){var M=k[WH.statToJson[d]];if(L.statsInfo[d]){if(typeof L[WH.statToJson[d]]=="number"||!L[WH.statToJson[d]]){var l=L[WH.statToJson[d]]?L[WH.statToJson[d]]:M;L[WH.statToJson[d]]={};L[WH.statToJson[d]]["min"]=l;L[WH.statToJson[d]]["max"]=l}var a=L[WH.statToJson[d]]["min"];var p=L[WH.statToJson[d]]["max"];if(M<a){L[WH.statToJson[d]]["min"]=M}else{if(M>p){L[WH.statToJson[d]]["max"]=M}}}}}}E=E.replace(/(<!--ilvl-->)\d+\+?/,function(P,Q){return Q+L.level+(L.previewLevel?"+":"")});var G=false;if(L.scadist){var B=WH.convertScalingFactor.SD;var m=B?B[L.scadist]:null;if(m&&m[21]){G=true;var v=(m[20]?m[20]:1);var C=m[21];g=((g&&g<=C)?g:C);E=E.replace(/(<!--lvl-->)\d+/g,function(P,Q){return Q+((g&&g<=C)?g:C)});E=E.replace(/(<!--minlvl-->)\d+/,function(P,Q){return Q+v});E=E.replace(/(<!--maxlvl-->)\d+/,function(P,Q){return Q+C});var H=false;E=E.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,function(T,V,S,P,Q,R,U){H=true;return"<!--i?"+V+":"+v+":"+C+":"+g+":"+L.scadist+":"+(U||0)});if(!H){E+="<!--i?"+s+":"+v+":"+C+":"+g+":"+L.scadist+":0-->"}E=E.replace(/(<!--huindex-->)\d+/,function(R,S){var T=0;if(L.scadistbonus&&L.heirloombonuses){for(var P=0,Q;Q=L.heirloombonuses[P];P++){if(parseInt(L.scadistbonus)===Q){T=P+1;break}}}return S+T})}}else{E=E.replace(/<!--i\?(\d+):(\d+):(\d+):(\d+)(?::(\d+):(\d+))?/,function(T,V,S,P,Q,R,U){return"<!--i?"+V+":"+S+":"+P+":"+(g?g:P)})}var K;if(K=WH.ge("sl"+s)){K.style.display=G?"":"none"}E=E.replace(/(<!--pvpilvl-->)\d+/,function(P,Q){return Q+(L.level+((J!="pvp")?L.pvpUpgrade:0))});E=E.replace(/(<!--ilvldelta-->)\d+/,function(Q,R){var P=1718;var S=Math.floor(WH.getCurveValue(P,L.level)||2);return R+S});E=E.replace(/(<!--rlvl-->)\d+/,function(P,Q){return Q+L.reqlevel});E=E.replace(/(<!--uindex-->)\d+/,function(P,Q){return(J&&J!="pvp")?(Q+J):P});var b=(typeof L.dmgrange!="undefined")&&L.dmgrange;var e=new RegExp("(<!--dmg-->)[\\d,]+"+(b?"(\\D*?)[\\d,]+":"")+"");E=E.replace(e,function(Q,R,P){return R+WH.numberFormat(L.dmgmin1)+(b?(P+WH.numberFormat(L.dmgmax1)):"")});E=E.replace(/(<!--dps-->\D*?)([\d,]+(?:\.\d+)?)/,function(Q,R){var P=L.dps>=1000?0:(WH.isClassicTree()?2:1);return R+(L.dps?WH.numberFormat(L.dps.toFixed(P)):"0")});E=E.replace(/(<!--amr-->)\d+/,function(P,Q){return Q+L.armor});E=E.replace(/<span><!--stat(\d+)-->[-+][\d\.,]+(\D*?)<\/span>(<!--e-->)?(<!--ps-->)?(<br ?\/?>)?/gi,function(Q,T,S,V,P,Y){var R,X=(L[WH.statToJson[T]]?L[WH.statToJson[T]]:0);if(X){var U=A&&X.min?X.min:X;var W=A&&X.max?X.max:X;X=(U>0?"+":"-")+WH.numberLocaleFormat(U!=W?(U+"-"+W):U);R="";Y=(Y?"<br />":"")}else{X="+0";R=' style="display: none"';Y=(Y?"<!--br-->":"")}return"<span"+R+"><!--stat"+T+"-->"+X+S+"</span>"+(V||"")+(P||"")+Y});var z=WH.getCombatRatingMult(L.level,g_items[s].slot);E=E.replace(/<span class="q2">((?:<!--stat\d+-->)?.*?[-+])<!--rtg(\d+)-->[\d\.,]+(.*?)<\/span>(<br \/>)?/gi,function(P,T,R,W,X){var Q,V=(L[WH.statToJson[R]]?L[WH.statToJson[R]]:0);if(V){var S=Math.floor((A&&V.min?V.min:V)*z);var U=Math.floor((A&&V.max?V.max:V)*z);V=WH.numberLocaleFormat(S!=U?(S+"-"+U):S);Q="";X=(X?"<br />":"")}else{Q=' style="display: none"';X=(X?"<!--br-->":"")}return'<span class="q2"'+Q+">"+T+"<!--rtg"+R+"-->"+V+W+"</span>"+X});if(L.extraStats&&L.extraStats.length){E=E.replace(/<!--re--><span[^<]*?<\/span>(<br \/>)?/,"");var r=WH.applyStatModifications.BASE_STATS;E=E.replace(/<!--ebstats-->/,function(X){var S="";for(var R=0;R<L.extraStats.length;++R){var P=L.extraStats[R];if(r.indexOf(P)==-1){continue}var U="$1$2 "+(WH.statToJson&&WH.statToJson[P]&&LANG.traits[WH.statToJson[P]]?LANG.traits[WH.statToJson[P]][1]:"Unknown");var T=WH.statToJson&&WH.statToJson[P]?L[WH.statToJson[P]]:0;var Q=Math.floor((A&&T.min?T.min:T)*z);var V=Math.floor((A&&T.max?T.max:T)*z);var W=WH.numberLocaleFormat(Q!=V?(Q+"-"+V):Q);S+="<br /><span><!--stat"+P+"-->"+WH.sprintf(U,(Q<0)?"-":"+",W)+"</span>"}return S+X});E=E.replace(/<!--egstats-->/,function(Z){var T="";for(var S=0;S<L.extraStats.length;++S){var Q=L.extraStats[S];if(r.indexOf(Q)!=-1){continue}var ac=z;var P="q2";switch(WH.statToJson[Q]){case"corruption":P="stat-corruption";ac=1;break;case"corruptionres":P="q6";ac=1;break}var W="$1$2 "+(WH.statToJson&&WH.statToJson[Q]&&LANG.traits[WH.statToJson[Q]]?LANG.traits[WH.statToJson[Q]][1]:"Unknown");var V=WH.statToJson&&WH.statToJson[Q]?L[WH.statToJson[Q]]:0;var R=Math.floor((A&&V.min?V.min:V)*ac);var X=Math.floor((A&&V.max?V.max:V)*ac);var Y=WH.numberLocaleFormat(R!=X?(R+"-"+X):R);var U=WH.sprintf("<!--rtg$1-->$2",Q,Y);var aa="";if(WH.statToRating&&WH.statToRating[Q]){aa=WH.sprintf("&nbsp;<small>(<!--rtg%$1-->0&nbsp;@&nbsp;L$2"+WH.maxLevel+")</small>",Q,A?"":"<!--lvl-->")}var ab="";if(Q==50){ab="<!--stat%d-->"}if(Q==64){W=W.substr(5);aa=""}T+='<br /><span class="'+P+'">'+ab+WH.sprintf(W,(R>=0)?"+":"-",U)+aa+"</span>"}return T+Z})}E=E.replace(/(<!--nstart-->)(.*)(<!--nend-->)/,function(T,Q,R,P){var V=L.quality;var S=L.name;var U=L.nameSuffix?(" "+L.nameSuffix):"";return Q+WH.sprintf('<b class="q$1">$2</b>',V,S+U)+P});E=E.replace(/(<!--ndstart-->)(.*)(<!--ndend-->)/,function(S,Q,P,T){if(!L.namedesc){return Q+T}if(!L.namedesccolor){return S}var R=parseInt(L.namedesccolor).toString(16);while(R.length<6){R="0"+R}return Q+WH.sprintf('<br /><span style="color: $1">$2</span>',"#"+R,L.namedesc)+T});var I=g_items[s].jsonequip.nsockets|0;if((!I&&L.nsockets)||(I&&L.nsockets>I)){E=E.replace(/<!--ps-->(<br(?: \/)?>)?/,function(V,X){var S="";for(var Q=I;Q<L.nsockets;++Q){if(!L["socket"+(Q+1)]){continue}var T=L["socket"+(Q+1)];var R="socket-unknown";var P=81;var U=T;switch(T){case 1:R="socket-meta";P=81;U=1;break;case 2:R="socket-red";P=81;U=2;break;case 3:R="socket-yellow";P=81;U=3;break;case 4:R="socket-blue";P=81;U=4;break;case 5:R="socket-hydraulic";P=81;U=5;break;case 6:R="socket-cogwheel";P=81;U=6;break;case 7:R="socket-prismatic";P=81;U=9;break;case 8:R="socket-relic-iron";P=225;U=64;break;case 9:R="socket-relic-blood";P=225;U=128;break;case 10:R="socket-relic-shadow";P=225;U=256;break;case 11:R="socket-relic-fel";P=225;U=512;break;case 12:R="socket-relic-arcane";P=225;U=1024;break;case 13:R="socket-relic-frost";P=225;U=2048;break;case 14:R="socket-relic-fire";P=225;U=4096;break;case 15:R="socket-relic-water";P=225;U=8192;break;case 16:R="socket-relic-life";P=225;U=16384;break;case 17:R="socket-relic-storm";P=225;U=32768;break;case 18:R="socket-relic-holy";P=225;U=65536;break;default:break}var W=WH.sprintf('<a href="/items/gems?filter=$1;$2;0" class="$3 q0">',P,U,R);W+=g_socket_names[T]?g_socket_names[T]:(g_gem_types[T]?WH.sprintf(LANG.tooltip_emptyrelicslot.replace("%s","$1"),g_gem_types[T]):"Unknown Socket");W+="</a>";S+="<br>"+W}return(I==0?"<br>":"")+S+"<br><br>"})}if(WH.data.bonusItemEffects&&WH.data.bonusItemEffects.bonus){E=E.replace(/<!--itemEffects:(\d)-->/,function(W,Q){var U=L.extraStats.indexOf(parseInt(WH.jsonToStat.corruption))>=0;var Y="";for(var V,T=0;V=O[T];T++){var X=WH.data.bonusItemEffects.bonus[V]||[];for(var R,S=0;R=X[S];S++){var P=WH.data.bonusItemEffects.effect[R];if(P){if(U){P=P.replace(/\b(class=")q2\b/g,"$1stat-corruption")}Y+=(Y?"<br>":"")+P}}}return Y+((Y&&Q)?"<br>":"")+W})}if(WH.applyStatModifications&&WH.convertScalingSpell.SpellInformation){var j;var N={effects:{}};var c=/(<!--pts(\d):(\d):(\d+(?:\.\d+)?):(\d+)(:\d+(?:\.\d+)?)?(:crm)?-->(?:<!--rtg\d+-->)?)(\d+(?:\.\d+)?)(<!---->(%?))?/g;while((j=c.exec(E))!==null){var h=j[2];var f=j[3];var t=j[5];if(t<=0){continue}N[t]=N[t]||{};WH.cO(N[t],WH.convertScalingSpell(N[t],t,h,f,g,L.level))}E=WH.adjustSpellPoints(E,N,L.level,g_items[s].jsonequip.slot)}var F=0;switch(u){case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL:F=70;break;case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL:F=80;break;case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL:F=85;break;case WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL:F=90;break;default:break}if(F){E=E.replace(/<!--ee(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,function(P,Y,Q,R,X,V,T,U){var W={enchantment:U,scalinginfo:{scalingcategory:Y,minlvlscaling:Q,maxlvlscaling:R,damage1:X/1000,damage2:V/1000,damage3:T/1000}};var S=WH.scaleItemEnchantment(W,F);return"<!--ee-->"+S+"</span>"})}E=E.replace(/(<!--rtg%(\d+)-->)([\.,0-9]+)%?/g,function(R,T,S,Q){_=E.match(new RegExp("<!--rtg"+S+"-->([\\d\\.,]+)(-[\\d\\.,]+)?"));if(!_){return R}if(_[2]){_[2]=_[2].replace(/\D/,"")}_[1]=_[1].replace(/\D/,"");var P=_[2]?((Math.abs(parseInt(_[2]))+parseInt(_[1]))/2):_[1];return T+(_[2]?"~":"")+(Math.round(WH.convertRatingToPercent(g?g:WH.maxLevel,S,P)*100)/100)+(S!=49?"%":"")});(function(){var P=WH.ce("div");P.innerHTML=E;P.querySelectorAll('a[href*="/spell="]').forEach(function(R){var Q=R.dataset.wowhead||"";Q=Q.replace(/(^|&)i?lvl=\d+/g,"");if(g){Q+=(Q?"&":"")+"lvl="+g}if(L.level){Q+=(Q?"&":"")+"ilvl="+L.level}R.dataset.wowhead=Q});E=P.innerHTML})();return E};WH.setTooltipLevel=function(e,b,w){var h=typeof e;if(h=="number"){var a=WH.getDataSource();if(a[e]&&a[e][(w?"buff_":"tooltip_")+Locale.getName()]){e=a[e][(w?"buff_":"tooltip_")+Locale.getName()]}else{return e}}else{if(h!="string"){return e}}e=e.replace(/<!--(gem|ee)(\d+):(\d+):(\d+):(\d+):(\d+):(\d+)-->([^<]*)<\/span>/gi,function(j,L,K,C,D,J,H,F,G){var I={enchantment:G,scalinginfo:{scalingcategory:K,minlvlscaling:C,maxlvlscaling:D,damage1:J/1000,damage2:H/1000,damage3:F/1000}};var E=WH.scaleItemEnchantment(I,b);return"<!--"+L+"-->"+E+"</span>"});var z=e.match(/<!--i?\?([0-9-:]*)-->/);var f;var n;if(z){f=z[1].split(":").map(Number);b=Math.min(f[2],Math.max(f[1],b));n=f[4]||0}if(n){if(!e.match(/<!--pts\d:\d:\d+(?:\.\d+)?:\d+-->/g)&&!(n<0)&&!w){e=WH.setItemModifications(e,f[0],null,null,b);WH.updateItemStringLink.call(this)}else{if(n>0){if(!f[7]&&WH.isSet("g_pageInfo")&&g_pageInfo.type==3&&g_items[g_pageInfo.typeId]&&g_items[g_pageInfo.typeId].quality!=7){b=Math.min(g_items[g_pageInfo.typeId].reqlevel,b)}var v={scadist:n};e=e.replace(/<!--cast-->\d+\.\d+/,"<!--cast-->"+v.cast);var m=/<!--pts([0-9-:]*)-->/g;var r=m.exec(e);v.effects=true;while(r!=null){var u=r[1].split(":").map(Number);var p=u[0];var B=u[1];var c=u[3];if(c>0){if(v[c]==undefined){v[c]={};v[c].effects={}}WH.cO(v[c],WH.convertScalingSpell(v[c],c,p,B,b,b))}r=m.exec(e)}if(v.effects){var d=5;var k=d;if(window.g_pageInfo&&window.g_pageInfo.type==WH.Types.AZERITE_ESSENCE_POWER){k=WH.Wow.Item.INVENTORY_TYPE_NECK}e=WH.adjustSpellPoints(e,v,b,k);if(this.modified){for(var l in this.modified[1]){var A=this.modified[1][l];for(var s=0;s<A.length;++s){A[s][0]=WH.adjustSpellPoints(A[s][0],v,b,k);A[s][1]=WH.adjustSpellPoints(A[s][1],v,b,k)}}}}}else{var o=-n;var g=WH.getSpellScalingValue(o,b);for(var t=0;t<3;++t){var q=f[5+t]/1000;e=e.replace(new RegExp("<!--gem"+(t+1)+"-->(.+?)<"),"<!--gem"+(t+1)+"-->"+Math.round(g*q)+"<")}}}}e=e.replace(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)(?::(1))?-->\s*\d+/gi,function(F,I,D,C,G,H,E){var j=E?Math.ceil:Math.floor;return"<!--ppl"+I+":"+D+":"+C+":"+G+":"+H+"-->"+j(parseInt(G)+(Math.min(Math.max(b,D),C)-D)*H/100)});e=e.replace(/(<!--rtg%(\d+)-->)([\.0-9]+)%?/g,function(C,E,D,j){_=e.match(new RegExp("<!--rtg"+D+"-->(\\d+)"));if(!_){return C}return E+(Math.round(WH.convertRatingToPercent(b,D,_[1])*100)/100)+(D!=49?"%":"")});e=e.replace(/(<!--i?\?\d+:\d+:\d+:)\d+/g,"$1"+b);e=e.replace(/<!--lvl-->\d+/g,"<!--lvl-->"+b);return e};WH.getSpellScalingValue=function(a,c){var b=WH.convertScalingSpell?WH.convertScalingSpell.SV:null;if(!b){return 0}return b[c][a-1]};WH.adjustSpellPoints=function(e,c,b,f){var a=1;if(b&&f){a=WH.getCombatRatingMult(b,f)}for(var d=1;d<=20;++d){e=e.replace(new RegExp("<!--pts"+d+":0:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(m,h,k,g,j){var l=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!l){return m}var n=Math.round(l.avg*(g?a:1));return"<!--pts"+d+":0:0:"+h+(k||"")+(g||"")+"-->"+(j?j:"")+n+"<"});e=e.replace(new RegExp("<!--pts"+d+":1:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(m,h,k,g,j){var l=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!l){return m}var n=Math.round(l.min*(g?a:1));return"<!--pts"+d+":1:0:"+h+(k||"")+(g||"")+"-->"+(j?j:"")+n+"<"});e=e.replace(new RegExp("<!--pts"+d+":2:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(m,h,k,g,j){var l=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!l){return m}var n=Math.round(l.max*(g?a:1));return"<!--pts"+d+":2:0:"+h+(k||"")+(g||"")+"-->"+(j?j:"")+n+"<"});e=e.replace(new RegExp("<!--pts"+d+":3:(\\d+(?:\\.\\d+)?):(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(n,m,h,k,g,j){var l=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!l){return n}var o=Math.round(l.avg*m*(g?a:1));return"<!--pts"+d+":3:"+m+":"+h+(k||"")+(g||"")+"-->"+(j?j:"")+o+"<"});e=e.replace(new RegExp("<!--pts"+d+":4:0:(\\d+)(:\\d+(?:\\.\\d+)?)?(:crm)?-->(<!--rtg\\d+-->)?(.+?)<","g"),function(m,h,k,g,j){var l=(c[h]&&c[h].hasOwnProperty("effects"))?c[h].effects[d]:c.effects[d];if(!l){return m}var n=Math.round(l.pts*(g?a:1));return"<!--pts"+d+":4:0:"+h+(k||"")+(g||"")+"-->"+(j?j:"")+n+"<"})}return e};WH.getStaminaRatingMult=function(b,d){var a=0;switch(d){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1;break}var c=WH.hasOwnProperty("staminaFactor")?WH.staminaFactor[b][a]:1;if(typeof c=="undefined"){c=1}return c};WH.getCombatRatingMult=function(d,c){var a=0;switch(c){case 2:case 11:a=3;break;case 12:a=2;break;case 13:case 14:case 15:case 17:case 21:case 22:case 23:case 25:case 26:a=1;break}var b=(WH.convertRatingToPercent.hasOwnProperty("RM")&&WH.convertRatingToPercent.RM.hasOwnProperty(d))?WH.convertRatingToPercent.RM[d][a]:1;if(typeof b=="undefined"){b=1}return b};WH.roundArtifactPower=function(b){var a=1;if(b>50){a=5}if(b>1000){a=25}if(b>5000){a=50}return WH.roundHalfEven(b/a)*a};WH.roundHalfEven=function(b){if(Math.floor(b*100000)%100000==50000){var a=Math.floor(b);return a+a%2}return Math.round(b)};WH.setTooltipSpells=function(g,l,h,H){l=l||[];h=h||{};if(H===undefined){var B=function(J){var I=[];if(J.hasOwnProperty("data")){I.push(J.data)}for(var j=0;j<J.children.length;j++){I=I.concat(B(J.children[j]))}return I};for(var e in h){if(!h.hasOwnProperty(e)){continue}if(h[e].length<2){continue}for(var p=0;p<h[e].length;p++){h[e][p]={data:h[e][p],children:[]};var r=0;for(var o=0;o<=1;o++){var b=-1;while((b=h[e][p].data[o].indexOf("<!--sp"+e+"-->",b+1))>=0){r++}}var F=p-r;if(F<0){continue}while(r-->0){var k=h[e].splice(F,1);p--;h[e][p].children.push(k[0])}}h[e]=B({children:h[e]})}}H=H||{};var f=function(j){H[j]=(H[j]||0)+1;if(H[j]>=(h[j]||[]).length){H[j]=0}};var w=[];var d=/<!--sp([0-9]+):[01]-->/g;var m;while(m=d.exec(g)){var v=m[0];var G=m.index+v.length;var n="<!--sp"+m[1]+"-->";var u=g.indexOf(n,G);if(u<0){WH.warn("Could not find closing end tag for tooltip spell.",n,g);return g}var E=new RegExp("<!--sp"+m[1]+":[01]-->","g");E.lastIndex=G;var q=E.exec(g);while(q&&q.index<u){u=g.indexOf(n,u+n.length);if(u<0){WH.warn("Could not find nested closing end tag for tooltip spell.",n,g);return g}q=E.exec(g)}w.push(g.substring(m.index,u+n.length));d.lastIndex=u+n.length}var c=0;var D=/^(<!--sp([0-9]+):[01]-->).*(<!--sp\2-->)$/;for(var C=0;C<w.length;++C){var e=w[C].match(D)[2];var a=WH.inArray(l,parseInt(e))>=0?1:0;if(h[e]==null){continue}if(H[e]==null){H[e]=0}var s=h[e][H[e]];if(s==null||s[a]==null){continue}f(e);if(a&&(m=s[2].match(/^(!)(\d+)$/))){if(m[1]){if(WH.inArray(l,parseInt(m[2]))>=0){a=0}}else{if(WH.inArray(l,parseInt(m[2]))<0){a=0}}}var A=s[a];A=WH.setTooltipSpells(A,l,h,H);var t="<!--sp"+e+":"+a+"-->"+A+"<!--sp"+e+"-->";g=g.substr(0,c)+g.substr(c).replace(w[C],t);c=g.indexOf(t,c)+t.length;if(a){for(var z=C+1;z<w.length;z++){if(g.indexOf(w[z],c)!==c){break}m=w[z].match(D);t=m[1]+m[3];g=g.substr(0,c)+g.substr(c).replace(w[z],t);f(m[2]);c+=t.length;C++}}}return g};WH.enhanceTooltip=function(M,L,v,T,s,g,b,R,Q,z,d,H,J,I){if((!WH.applyStatModifications||!WH.applyStatModifications.ScalingData)&&(I||R)){g_itemScalingCallbacks.push((function(ab){return function(){var ac=WH.enhanceTooltip.call(ab,M,L,v,T,s,g,b,R,Q,z,d,H,J,I);WH.updateTooltip.call(ab,ac)}})(this));return LANG.tooltip_loading}var aa=typeof M,X,N;var u=WH.getDataSource();var n=WH.isSet("g_pageInfo")?g_pageInfo.type:null;N=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;this._knownSpells=g;if(aa=="number"){N=M;var O="tooltip_";if(s){O="buff_"}if(H){O="tooltip_premium_"}if(J){O="text_"}if(u[N]&&u[N][O+Locale.getName()]){M=u[N][O+Locale.getName()];X=u[N][(s?"buff":"")+"spells_"+Locale.getName()];this._rppmModList=u[N]["rppmmod"];if(X){M=WH.setTooltipSpells(M,g,X)}}else{return M}}else{if(aa!="string"){return M}}var o;if(v){var Y=WH.getGets();if(Y.lvl){M=WH.setTooltipLevel(M,Y.lvl,s)}o=Y.ilvl}if((I||R)&&N){M=WH.setItemModifications(M,N,I,R,this._selectedLevel?this._selectedLevel:null,o)}if(L){M=M.replace(/\(([^\)]*?<!--lvl-->[^\(]*?)\)/gi,function(ac,ab){return'(<a href="javascript:;" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH.staticTooltipLevelClick(this, null, 0)" onmouseover="WH.Tooltip.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + LANG.tooltip_changelevel + \'</span>\')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">'+ab+"</a>)"});if(M.indexOf("<!--artpow:")>0){if(!this.hasOwnProperty("_knowledgeLevel")){var D=/(&|\?)artk=(\d+)/.exec(location.href);if(D&&parseInt(D[2])<=g_artifact_knowledge_max_level){this._knowledgeLevel=parseInt(D[2])}}var C=this._knowledgeLevel?parseInt(this._knowledgeLevel):0;M=M.replace(/(<!--ndstart-->)?<!--ndend-->/i,function(ab,ac){return(ac?ac+"<br />":" ")+'<a href="javascript:;" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="WH.staticTooltipKnowledgeLevelClick(this, null, '+N+')" onmouseover="WH.Tooltip.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + LANG.tooltip_changelevel + \'</span>\')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">'+WH.sprintf(LANG.tooltip_knowledgeformat.replace("%d","$1"),C)+"</a>"});M=M.replace(/(<!--artpow:(\d+)-->)[\d\.\,]+/,function(ab,ad,ac){return ad+WH.numberLocaleFormat(WH.roundArtifactPower(parseInt(ac)*WH.getArtifactKnowledgeMultiplier(C)))})}}if(T&&Slider){var S=WH.groupSizeScalingShouldShow(N);if(s){s.bufftip=this;if(S&&WH.isSet("g_difficulties")&&g_difficulties[S]){M=WH.groupSizeScalingOnChange.call(s,this,g_difficulties[S].maxplayers,1,true)}}else{var e=new RegExp("<!--"+((n&&n==3)?"i":"")+"\\?(\\d+):(\\d+):(\\d+):(\\d+)");var k=M.match(e);if(typeof k=="undefined"&&n==3){e=new RegExp("<!--\\?(\\d+):(\\d+):(\\d+):(\\d+)");k=M.match(e)}if(!k&&WH.isClassicTree()){e=new RegExp("<!--ppl(\\d+):(\\d+):(\\d+):(\\d+):(\\d+)");var a=M.match(e);if(a){k=[null,null,a[2],WH.maxLevel,WH.maxLevel]}}if(S&&WH.isSet("g_difficulties")&&g_difficulties[S]){var p=WH.ce("label");p.innerHTML=LANG.tooltip_difficulty+": ";this._difficultyBtn=WH.ce("a");this._difficultyBtn.ttId=N;WH.difficultyBtnBuildMenu.call(this,N);Menu.add(this._difficultyBtn,this._difficultyBtn.menu);$("#dd"+N).append(p).append(this._difficultyBtn);WH.difficultyBtnOnChange.call(this,u[N].initial_dd||S,u[N].initial_ddSize);M=WH.groupSizeScalingOnChange.call(this,this,g_difficulties[S].maxplayers,0,true)}else{if(k){if(k[2]!=k[3]){this.slider=Slider.init(T,{maxValue:parseInt(k[3]),minValue:parseInt(k[2]),onMove:WH.tooltipSliderMove.bind(this),title:WH.GlobalStrings.LEVEL});Slider.setValue(this.slider,parseInt(k[4]));this.slider.onmouseover=function(ab){WH.Tooltip.showAtCursor(ab,LANG.tooltip_changelevel2,0,0,"q2")};this.slider.onmousemove=WH.Tooltip.cursorUpdate;this.slider.onmouseout=WH.Tooltip.hide;this.slider.input.onmouseover=function(ab){WH.Tooltip.showAtCursor(ab,LANG.tooltip_changelevel,0,0,"q2")};this.slider.input.onmousemove=WH.Tooltip.cursorUpdate;this.slider.input.onmouseout=WH.Tooltip.hide}}}}}if(b){if(s&&s.modified){s.bufftip=this}else{var W=0;for(var Z in X){if(X.hasOwnProperty(Z)&&g_spells.hasOwnProperty(Z)&&WH.inArray(g,Z)==-1){W++}}var E;for(var Z in X){if(!g_spells[Z]||WH.inArray(g,Z)!=-1){continue}if(W<4){var U=WH.ce("label");var f=WH.ce("input",{type:"checkbox",dataset:{spellId:Z}});WH.ae(U,f);WH.aE(f,"click",WH.tooltipSpellsChange.bind(this));WH.ae(U,WH.ce("a",{dataset:{wowhead:"spell="+Z+"&know="+Z}},WH.ct(g_spells[Z]["name_"+Locale.getName()]+(g_spells[Z]["rank_"+Locale.getName()]||""))));U.setAttribute("unselectable","");WH.ae(b,U);WH.ae(b,WH.ce("br"))}else{if(!E){E=WH.ce("select");E.multiple=true;E.size=6;WH.ae(b,E);WH.aE(E,"change",WH.tooltipSpellsChange.bind(this))}WH.ae(E,WH.ce("option",{value:Z},WH.ct(g_spells[Z]["name_"+Locale.getName()]+(g_spells[Z]["rank_"+Locale.getName()]||""))))}}}this.modified=[b,X,g];$(b).toggle(!$(b).is(":empty"))}if(d){var a=M.match(/<!--rppm-->(\d+(?:\.\d+)?)<!--rppm-->/);if(a){var l=$("#rppm"+N);if(this._rppmModList.hasOwnProperty(4)){this._rppmModBase=parseFloat(a[1]);if(l.is(":empty")){this._rppmSpecModList=this._rppmModList[4];this._rppmSpecModList.splice(0,0,{spec:-1,modifiervalue:0,filename:""});l.append(WH.getMajorHeading(LANG.realppmmodifiers,2,3));for(var Z in this._rppmSpecModList){var q=Icon.create(this._rppmSpecModList[Z]["filename"],0,null);q.style.display="inline-block";q.style.verticalAlign="middle";var j=$('<input name="rppmmod" type="radio" id="rppm-'+Z+'" />');j.get(0).checked=(this._rppmSpecModList[Z]["spec"]==-1);l.append(j).append(this._rppmSpecModList[Z]["spec"]==-1?"":q).append('<label for="rppm-'+Z+'"> <a>'+(this._rppmSpecModList[Z]["spec"]==-1?WH.TERMS.none:g_chr_specs[this._rppmSpecModList[Z]["spec"]])+"</a></label>").append("<br />");var P=this;$("#rppm-"+Z).change(function(){WH.tooltipRPPMChange.call(this,P)})}}else{var w=this._rppmModBase;var B=this._rppmSpecModList;M=M.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,function(ab,ae,ad,ac){return"<!--rppm-->"+ae+(w*(1+parseFloat(B[$('input[name="rppmmod"]:checked',l).attr("id").match(/\d+$/)[0]].modifiervalue))).toFixed(2)+ac+"<!--rppm-->"})}}l.toggle(!(l.is(":empty")));var G="";if(this._rppmModList.hasOwnProperty(1)){G+=" + "+LANG.traits.hastertng[2]}else{if(this._rppmModList.hasOwnProperty(2)){G+=" + "+LANG.traits.critstrkrtng[2]}}if(g_pageInfo.type==6&&this._rppmModList.hasOwnProperty(6)){G+=" + Budget"}if(G.length>0){M=M.replace(/<!--rppm-->\[?(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,function(ab,ad,ac){return"<!--rppm-->["+ad+G+"]"+ac+"<!--rppm-->"})}}}if(z){for(Z=1;Z<=Q;++Z){$(z).append('<input type="checkbox" id="item-upgrade-'+Z+'" />').append('<label for="item-upgrade-'+Z+'"><a>'+WH.sprintf(LANG.itemupgrade_format,Z)+"</a></label>").append("<br />");$("#item-upgrade-"+Z).change(WH.upgradeItemTooltip.bind(this,z,Z))}if(u[N]&&u[N].hasOwnProperty("tooltip_"+Locale.getName()+"_pvp")){$(z).append('<input type="checkbox" id="item-upgrade-pvp" />').append('<label for="item-upgrade-pvp"><a>'+LANG.su_menu_pvpmode+"</a></label>").append("<br />");$("#item-upgrade-pvp").change(WH.upgradeItemTooltip.bind(this,z,"pvp"))}if(u[N]&&u[N].hasOwnProperty("tooltip_"+Locale.getName()+"_twtbc")){$(z).append('<input type="checkbox" id="item-upgrade-twtbc" />').append('<label for="item-upgrade-twtbc"><a>'+g_difficulty_names[24]+" "+LANG.su_note_bc+"</a></label>").append("<br />");$("#item-upgrade-twtbc").change(WH.upgradeItemTooltip.bind(this,z,"twtbc"))}if(u[N]&&u[N].hasOwnProperty("tooltip_"+Locale.getName()+"_twwotlk")){$(z).append('<input type="checkbox" id="item-upgrade-twwotlk" />').append('<label for="item-upgrade-twwotlk"><a>'+g_difficulty_names[24]+" "+LANG.su_note_wotlk+"</a></label>").append("<br />");$("#item-upgrade-twwotlk").change(WH.upgradeItemTooltip.bind(this,z,"twwotlk"))}if(u[N]&&u[N].hasOwnProperty("tooltip_"+Locale.getName()+"_twcata")){$(z).append('<input type="checkbox" id="item-upgrade-twcata" />').append('<label for="item-upgrade-twcata"><a>'+g_difficulty_names[24]+" "+LANG.su_note_cata+"</a></label>").append("<br />");$("#item-upgrade-twcata").change(WH.upgradeItemTooltip.bind(this,z,"twcata"))}if(u[N]&&u[N].hasOwnProperty("tooltip_"+Locale.getName()+"_twmists")){$(z).append('<input type="checkbox" id="item-upgrade-twmists" />').append('<label for="item-upgrade-twmists"><a>'+g_difficulty_names[24]+" "+LANG.su_note_mists+"</a></label>").append("<br />");$("#item-upgrade-twmists").change(WH.upgradeItemTooltip.bind(this,z,"twmists"))}$(z).toggle(!$(z).is(":empty"))}if(n==3){var r=$("#cs"+N);if(r&&WH.Wow.Item.tooltipHasSpecStats(M)){if(!this._classSpecBtn){var t=WH.ce("label");t.innerHTML=LANG.tooltip_showingtooltipfor+" ";this._classSpecBtn=WH.ce("a");this._classSpecBtn.ttId=N;WH.classSpecBtnBuildMenu.call(this,u[N].hasOwnProperty("validMenuSpecs")?u[N].validMenuSpecs:false);Menu.add(this._classSpecBtn,this._classSpecBtn.menu);r.append(t).append(this._classSpecBtn).show()}var F=WH.LocalStorage.get("tooltips_class:spec");F=F?F.split(":"):null;var V=/(&|\?)class=(\d+)/.exec(location.href);if(V){F=[V[2],0]}var A=/(&|\?)spec=(\d+)/.exec(location.href);var K,m;if(A){K=A[2];m=WH.Wow.PlayerClass.getClassFromSpec(K);if(m){F=[m,K]}}if(F&&F.length==2){M=WH.classSpecBtnOnChange.call(this,F[0],F[1],M,true)}else{$(this._classSpecBtn).text(WH.isClassicTree()?WH.TERMS.chooseAClass_stc:WH.TERMS.chooseaspec_stc)}}}if(u[N]&&WH.bonusesBtnShouldShow(u[N].bonusesData)){var c=$("#bs"+N);if(c&&!this._bonusesBtn){var h=WH.ce("label");h.innerHTML=LANG.tooltip_itembonuses+": ";this._bonusesBtn=WH.ce("a");this._bonusesBtn.ttId=N;this._bonusesBtn.menu=WH.bonusesBtnBuildMenu.call(this,u[N]);Menu.add(this._bonusesBtn,this._bonusesBtn.menu);$(this._bonusesBtn).text(LANG.selectbonus);c.append(h).append(this._bonusesBtn).show();if(I!==""){WH.bonusesBtnOnChange.call(this,I,true)}}}if(n==3){WH.updateItemStringLink.call(this)}return M};WH.getEventNextDates=function(b,e){if(e==null){e=WH.getServerTime()}var g=null;var o=null;if(b.dates[0]==""&&b.startDate){b.dates[0]=b.startDate}var h=b.duration0?b.duration0:0;var f=b.duration1?b.duration1:0;var a=b.filtertype?b.filtertype:0;var q=0;for(var n=0;n<b.dates.length;++n){if(b.dates[n]&&b.dates[n]!=""){++q}}if(q>0){if(q>1){for(var n=0;n<b.dates.length;++n){if(!b.dates[n]||b.dates[n]==""){continue}var d=new Date(b.dates[n]).getTime();var k;if(f){d+=h*3600*1000;k=d+f*3600*1000}else{k=d+h*3600*1000}if(e.getTime()<k||(n==b.dates.length-1)){g=new Date();g.setTime(d);o=new Date();o.setTime(k);break}}}else{if(a==-1){if(b.rec&&b.rec==-2){g=new Date(b.dates[0]);o=new Date();o.setTime(g.getTime()+h*3600*1000)}else{var p=b.dates[0];if(p==0&&b.dates[7]>0){p=b.dates[7]}var d=new Date(p);for(var n=0;n<2;++n){var m=new Date(e.getFullYear()+n,d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds()).getTime();var j;if(f){m+=h*3600*1000;j=m+f*3600*1000}else{j=m+h*3600*1000}if(e.getTime()<j){g=new Date();g.setTime(m);o=new Date();o.setTime(j);break}}}}else{var d=new Date(b.dates[0]).getTime();if(b.id==301){d-=24*3600*1000}var k=d+h*3600*1000;var c=0;if(f>0){c=(h+f)*3600*1000}else{switch(a){case 0:c=7*24*3600*1000;break;default:break}}var l=0;if(c>0){l=Math.ceil((e.getTime()-k)/c)*c}g=new Date();g.setTime(d+l);o=new Date();o.setTime(k+l)}}}return[g,o]};WH.groupSizeScalingShouldShow=function(a){if(WH.isSet("g_difficulties")&&WH.isSet("g_spells")&&g_spells[a]&&g_spells[a].difficulties&&g_spells[a].difficulties.length>0){return g_spells[a].difficulties[0]}return false};WH.groupSizeScalingSliderMove=function(j,f,c){var b=WH.getDataSource();var d=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(!b[d]){return}var a=this._difficultyBtn.selectedDD;var h=c.value;var g="";if(a!=WH.groupSizeScalingShouldShow(d)||h!=g_difficulties[WH.groupSizeScalingShouldShow(d)].maxplayers){g="&dd="+a+"&ddsize="+h}if(window.history){if(location.pathname.indexOf("&dd")!=-1){window.history.replaceState({},"",location.pathname.replace(/&ddsize=\d+/i,"").replace(/&dd=\d+/i,g)+location.hash)}else{if(!location.hash){window.history.replaceState({},"",location.pathname+g)}else{window.history.replaceState({},"",location.pathname+g+location.hash)}}}WH.groupSizeScalingOnChange.call(this,this,c.value,0);if(this.bufftip){WH.groupSizeScalingOnChange.call(this,this.bufftip,c.value,1)}WH.Tooltip.hide()};WH.groupSizeScalingOnChange=function(a,c,m,n){while(a.className.indexOf("tooltip")==-1){a=a.parentNode}c=parseInt(c);if(isNaN(c)){return}var f=WH.getDataSource();var h=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(!f[h]){return}var o=this;var e=this._difficultyBtn.selectedDD;var k=Locale.getName();var d="server_"+(m?"buff_":"tooltip_")+k;var l="dd"+e+"ddsize"+c;WH.groupSizeScalingOnChange.lastCall=l;if(!f[h][d]){f[h]["server_tooltip_"+k]={};f[h]["server_buff_"+k]={};var b="dd"+f[h].initial_dd+"ddsize"+f[h].initial_ddSize;f[h]["server_tooltip_"+k][b]=f[h]["tooltip_"+k];f[h]["server_buff_"+k][b]=f[h]["buff_"+k]}if(f[h][d][l]){var g=f[h][d][l];if(n){return g}WH.updateTooltip.call(a,g);return}if(n){return f[h][d.substr(7)]}if(m){return}if(f[h][d].hasOwnProperty(l)){return}f[h][d][l]="";var j="/spell="+h+"&dd="+e+"&ddsize="+c;if(WH.isBeta()||WH.isPtr()){j+="&"+WH.getDataBuild()}WH.xhrJsonRequest(j,(function(p){if(!p){return}f[h]["server_tooltip_"+k][l]=p.tooltip;f[h]["server_buff_"+k][l]=p.buff;if(WH.groupSizeScalingOnChange.lastCall===l){WH.groupSizeScalingOnChange.call(o,a,c);if(o.bufftip){WH.groupSizeScalingOnChange.call(o,o.bufftip,c,true)}}}))};WH.difficultyBtnBuildMenu=function(f){var e=[];var a=g_spells[f];for(var d=0;d<a.difficulties.length;++d){var c=a.difficulties[d];var b=[c,g_difficulty_names[c],WH.difficultyBtnOnChange.bind(this,c,false)];e.push(b)}this._difficultyBtn.menu=e};WH.difficultyBtnOnChange=function(b,d){this._difficultyBtn.selectedDD=b;$(this._difficultyBtn).text("");WH.arrayWalk(this._difficultyBtn.menu,function(j){j.checked=false});var h=Menu.findItem(this._difficultyBtn.menu,[b]);h.checked=true;$(this._difficultyBtn).text(h[MENU_IDX_LABEL]);var f=this._difficultyBtn.selectedPlayers||d;var e=g_difficulties[b].minplayers,a=g_difficulties[b].maxplayers,c=g_difficulties[b].maxplayers;if(f){if(f>a){c=a}else{if(f<e){c=e}else{c=f}}}e=a;var g=$("#sl"+this._difficultyBtn.ttId);g.html("").hide();this.slider=null;if(e!=a){g.show();this.slider=Slider.init(g.get(0),{maxValue:parseInt(a),minValue:parseInt(e),onMove:WH.groupSizeScalingSliderMove.bind(this),title:WH.TERMS.players});Slider.setValue(this.slider,parseInt(c));this.slider.onmouseover=function(j){WH.Tooltip.showAtCursor(j,LANG.tooltip_changeplayers2,0,0,"q2")};this.slider.onmousemove=WH.Tooltip.cursorUpdate;this.slider.onmouseout=WH.Tooltip.hide;this.slider.input.onmouseover=function(j){WH.Tooltip.showAtCursor(j,LANG.tooltip_changeplayers,0,0,"q2")};this.slider.input.onmousemove=WH.Tooltip.cursorUpdate;this.slider.input.onmouseout=WH.Tooltip.hide}WH.groupSizeScalingSliderMove.call(this,null,null,{value:c})};WH.classSpecBtnOnChange=function(f,j,k,g){f=parseInt(f);j=j?parseInt(j):null;$(this._classSpecBtn).html("");this._classSpecBtn.selectedSpec=j;var a=$("<span></span>");a.text(" "+(WH.isClassicTree()?g_chr_classes[f]:WH.Strings.sprintf(WH.TERMS.specclass_format,g_chr_specs[j],g_chr_classes[f])));var b=Menu.findItem(this._classSpecBtn.menu,[f,j]);if(b&&b[Menu.ITEM_OPTIONS]&&b[Menu.ITEM_OPTIONS].tinyIcon){var e=b[Menu.ITEM_OPTIONS].tinyIcon;var h=Icon.create(e,0,null,"javascript:;");h.style.display="inline-block";h.style.verticalAlign="middle";$(this._classSpecBtn).append(h)}$(this._classSpecBtn).append(a);if(!g){WH.LocalStorage.set("tooltips_class:spec",f+":"+j)}var d=k?k:this.innerHTML;d=d.replace(/<!--scstart(\d+):(\d+)--><span class="q(\d+)">(<!--asc\d+-->)?(.*?)<\/span><!--scend-->/i,function(q,n,o,m,p,l){m=1;var s=n==2&&(!g_classes_allowed_weapon[f]||WH.inArray(g_classes_allowed_weapon[f],o)==-1);var r=n==4&&(!g_classes_allowed_armor[f]||WH.inArray(g_classes_allowed_armor[f],o)==-1);if(s||r){m=10}return"<!--scstart"+n+":"+o+'--><span class="q'+m+'">'+(p?p:"")+l+"</span><!--scend-->"});if(!WH.isClassicTree()){d=d.replace(/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?)(\D*?)<\/span>/gi,function(r,q,n,m){q=parseInt(q);var o=q==50?' class="q2"':"";if(g_grayedOutStats[q]&&(g_grayedOutStats[q].indexOf(j)!=-1)){o=' class="q0"'}var l=WH.getStatForSpec(q,parseInt(j));if(l!==q&&WH.statToJson[l]){var p=LANG.traits[WH.statToJson[l]];if(p){m=" "+p[1]}}return"<span"+o+"><!--stat"+q+"-->"+n+m+"</span>"});d=d.replace(/(<!--traitspecstart:(\d+)(?::(\d+))?-->)[\w\W]*?(<!--traitspecend-->)/g,function(p,o,l,n,m){var q="";if(WH.isSet("g_pageInfo")&&g_pageInfo.hasOwnProperty("typeId")&&g_pageInfo.type==3&&g_items.hasOwnProperty(g_pageInfo.typeId)&&g_items[g_pageInfo.typeId].hasOwnProperty("affectsArtifactPowerTypesData")&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData.hasOwnProperty(l)&&g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[l].hasOwnProperty(j)){q=g_items[g_pageInfo.typeId].affectsArtifactPowerTypesData[l][j]}else{if(n){q='<span style="color: #00FF00">'+WH.sprintf(LANG["tooltip_relicrank"+(n>1?"s":"")+"increase"].replace("%d","$1"),n)+": </span>"+LANG.tooltip_relicminortrait}}return o+q+m})}if(window.history){var c;if(WH.isClassicTree()){if(location.pathname.indexOf("&class")!==-1){c=location.pathname.replace(/&class=\d+/,"&class="+f)}else{c=location.pathname+"&class="+f}}else{if(location.pathname.indexOf("&spec")!==-1){c=location.pathname.replace(/&spec=\d+/,"&spec="+j)}else{c=location.pathname+"&spec="+j}}if(location.hash){c+=location.hash}window.history.replaceState({},"",c)}if(!k){this.innerHTML=WH.Tooltip.evalFormulas(d)}return d};WH.classSpecBtnBuildMenu=function(k){var d=[];if(WH.isClassicTree()){d.push([,WH.TERMS.chooseAClass_stc]);var j=Menu.findItem(mn_spells,[7]);d=d.concat($.extend(true,[],Menu.getSubmenu(j)))}else{d.push([,WH.TERMS.chooseaspec_stc]);var o=Menu.findItem(mn_spells,[-12]);d=d.concat($.extend(true,[],Menu.getSubmenu(o)))}for(var l in g_chr_specs_by_class){var f=g_chr_specs_by_class[l];for(var n in d){var b=d[n];if(b[Menu.ITEM_NAME]==l){if(WH.isClassicTree()){b[Menu.ITEM_URL]=WH.classSpecBtnOnChange.bind(this,l,0,false)}else{if(b[Menu.ITEM_URL]){b[Menu.ITEM_URL]=null}for(var e=0,m=f.length;e<m;e++){var a=Menu.getSubmenu(d[n]);for(var g=0,c=a.length;g<c;g++){var h=a[g];if(h[Menu.ITEM_NAME]==f[e]){if(k&&(WH.inArray(k,f[e])<0)){delete h[Menu.ITEM_OPTIONS].tinyIcon;h[Menu.ITEM_OPTIONS].className="q0";h[Menu.ITEM_URL]="javascript:;"}else{h[Menu.ITEM_URL]=WH.classSpecBtnOnChange.bind(this,l,f[e],false)}break}}}}break}}}this._classSpecBtn.menu=d};WH.getStatForSpec=function(d,m){var a=3;var n=4;var h=5;var b=71;var j=72;var f=73;var g=74;var c;var e;var l=g_specPrimaryStatOrders[m];var k=g_specPrimaryStatOrders[m].length;if(d===b){e=0;if(!k){return h}while(1){c=l[e];if(c>=a&&c<=h){break}e++;if(e>=k){return h}}}else{if(d!==j){if(d!==f){if(d!==g){return d}e=0;if(k){while(1){c=l[e];if(c>=n&&c<=h){break}e++;if(e>=k){return h}}return c}return h}e=0;if(k){while(1){c=l[e];if(l[e]===a){break}if(l[e]===h){break}e++;if(e>=k){return h}}return c}return h}e=0;if(!k){return a}while(1){c=l[e];if(c>=a&&c<=n){break}e++;if(e>=k){return a}}}return c};WH.bonusesBtnShouldShow=function(a){for(var b in a){if(a.hasOwnProperty(b)){return true}}return false};WH.bonusesBtnBuildMenu=function(q){var t=[];var e=q.bonusesData;if(e){for(var h in e){var r=e[h].groupedUpgrade;var m=WH.getItemBonusName.call(this,h,q);var d=[h,m,WH.bonusesBtnOnChange.bind(this,(r?"u:":"")+h,false)];if(typeof r=="undefined"){for(var n in e[h].sub){r=e[h].sub[n].groupedUpgrade;m=WH.getItemBonusName.call(this,n,q,h);if(m=="???"){continue}var g=[n,m,WH.bonusesBtnOnChange.bind(this,h+":"+(r?"u:":"")+n,false,true)];Menu.addToSubmenu(d,g)}}var k=Menu.getSubmenu(d);if(k){k.sort(function(v,u){var z=WH.getItemBonusChanceType(v[Menu.ITEM_NAME]);var w=WH.getItemBonusChanceType(u[Menu.ITEM_NAME]);return WH.stringCompare(z,w)||WH.stringCompare(v[MENU_IDX_LABEL],u[MENU_IDX_LABEL])});var s=[];var c=0;for(var p=0;p<k.length;++p){var n=k[p][MENU_IDX_NAME];if(n&&e[h].sub[n].type!=c){c=e[h].sub[n].type;var o=LANG.unknown;switch(c){case 1:o=LANG.upgrades;break;case 2:o=LANG.su_note_stats;break;case 4:o=LANG.sockets;break;default:break}s.push([p,o])}}for(var p=0;p<s.length;++p){var b=s[p][0]+p;var l=[null,s[p][1]];k.splice(b,0,l)}}t.push(d)}var f={};for(var j=0;j<t.length;j++){if(f.hasOwnProperty(t[j][1])){t[j][1]+=LANG.wordspace+LANG.parens_open+ ++f[t[j][1]]+LANG.parens_close}else{f[t[j][1]]=1}}t.sort(function(w,u){var z=w[1].innerText?w[1].innerText:w[1];var v=u[1].innerText?u[1].innerText:u[1];return WH.stringCompare(z,v)})}var a=[[null,LANG.selectbonus]];if(t.length>0){a=a.concat(t)}return a};WH.getItemBonusChanceType=function(f){var e=0;if(f>0&&WH.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[f]){var a=g_itembonuses[f];for(var c=0;c<a.length;++c){var b=a[c];var d=0;switch(b[0]){case 1:case 3:case 4:case 5:case 11:d=1;break;case 2:d=2;break;case 6:d=4;break;default:break}if(d&&(!e||d<e)){e=d}}}return e};WH.getItemBonusUpgradeType=function(d){if(d>0&&WH.isSet("g_itembonuses")&&g_itembonuses&&g_itembonuses[d]){var a=g_itembonuses[d];for(var c=0;c<a.length;++c){var b=a[c];switch(b[0]){case 3:case 4:case 5:case 11:return 1<<b[0];default:break}}}return 0};WH.getItemBonusName=function(g,p,f){var h="";var c=p.level;if(f&&WH.isSet("g_itembonuses")&&f>0&&g_itembonuses[f]){for(var d=0;d<g_itembonuses[f].length;++d){var l=g_itembonuses[f][d];if(l[0]==1){c+=l[1]}}}if(WH.isSet("g_itembonuses")&&g>0&&g_itembonuses[g]){var e=g_itembonuses[g].slice();e.sort(function(q,j){return q[0]-j[0]});var a="";var o="";for(var d=0;d<e.length;++d){var l=e[d];switch(l[0]){case 1:a=LANG.itemlevel+" "+(c+l[1]);break;case 2:h+=(h?" / ":"")+((WH.statToJson[l[1]]&&LANG.traits[WH.statToJson[l[1]]])?LANG.traits[WH.statToJson[l[1]]][1]:"Unknown stat");break;case 3:o=l[1];break;case 4:if(WH.isSet("g_item_namedescriptions")&&g_item_namedescriptions[l[1]]){h+=(h?" / ":"")+g_item_namedescriptions[l[1]][0]}break;case 5:if(WH.isSet("g_item_namedescriptions")&&g_item_namedescriptions[l[1]]){h=g_item_namedescriptions[l[1]][0]}break;case 6:var k=l[2];h+=(h?" / ":"")+l[1]+" "+(g_socket_names[k]||(g_gem_types[k]?WH.sprintf(LANG.tooltip_emptyrelicslot.replace("%s","$1"),g_gem_types[k]):"Unknown Socket"));break;case 8:h+=(h?" / ":"")+WH.sprintf(LANG.tooltip_reqlevel_format.replace("%s","$1"),p.reqlevel+l[1]);break;case 11:if(p.heirloombonuses){var m="?";for(var b=0,n;n=p.heirloombonuses[b];b++){if(parseInt(g)===n){m=b+1;break}}h+=(h?" / ":"")+WH.sprintf(LANG.heirloomupgrade_format,m)}break;case 13:a=WH.TERMS.scaleswithlevel_stc;break;case 14:if(p.actualBonusLevels&&p.actualBonusLevels[g]){a=LANG.itemlevel+" "+p.actualBonusLevels[g]+"+"}else{a=LANG.itemlevel+" "+c+"+"}break;case 23:if(l[1]>0){h=WH.data.bonusItemEffects.effectSpellName[l[1]]||""}break;default:break}}h+=a?" / "+a:"";h+=(o&&p.quality!=o)?" / "+WH.Wow.Item.getQualityName(o):"";if(h.substr(0,3)==" / "){h=h.substr(3)}}else{if(g=="0"){h=LANG.normal}}return h?h:(f?LANG.parens_open+g+LANG.parens_close:LANG.normal)};WH.bonusesBtnGetContextBonusId=function(c){var b=0;if(c&&c.length){for(var a=0;a<c.length;++a){if(WH.isSet("g_itembonuses")&&g_itembonuses["-1"].indexOf(parseInt(c[a]))!=-1){b=c[a];break}}}return b};WH.bonusesBtnIsComboValid=function(g,d,h){if(!g[d]||!g[d].sub){return false}var e=g[d].sub;var f=32768;var c=32768;for(var a in h){var j=h[a];if(j!=d){if(e[j]){if((f&e[j].type)==1){}else{if(f&e[j].type){f=false;break}else{f|=e[j].type}}if(c&e[j].upgradeType){c=false;break}else{c|=e[j].upgradeType}}else{f=false;break}}}return f&&c};WH.bonusesGetItem=function(){var a=WH.getDataSource();var b=this._bonusesBtn.ttId;return a[b]};WH.bonusesGetDefaultAdjustmentBonus=function(c){var b=WH.bonusesGetItem.call(this);var a=WH.bonusesBtnGetContextBonusId(c);if(b.defaultAdjustmentBonuses[a]){return b.defaultAdjustmentBonuses[a].toString()}return null};WH.bonusesBtnOnChange=function(M,W,b){var z=WH.getDataSource();var A=this._bonusesBtn.ttId;var L=z[A].bonusesData;if(b===true){var e=M.split(":");var C=0;var u=e.indexOf("u");if(u!=-1){C=e[u+1];e.splice(u,1)}var l=e[0];var J=!Menu.findItem(this._bonusesBtn.menu,e).checked;var P=0;var p=[];WH.arrayWalk(this._bonusesBtn.menu,function(ac){if(ac.checked){P=ac[MENU_IDX_NAME];var j=Menu.getSubmenu(ac);if(j){WH.arrayWalk(j,function(ad){if(ad[MENU_IDX_NAME]&&ad.checked){p.push(ad[MENU_IDX_NAME]);if(P==l&&L[P].sub[ad[MENU_IDX_NAME]].groupedUpgrade&&!C){C=ad[MENU_IDX_NAME]}}})}}});var d;if(P==l){if(J){d=p.concat(e)}else{p.splice(p.indexOf(e[1]),1);d=p.concat([l])}}else{d=e}d.sort(function(ac,j){return ac-j});if(!WH.bonusesBtnIsComboValid(L,l,d)){d=e;var E=L[l].sub[e[1]].type;var K=L[l].sub[e[1]].upgradeType;for(var Y=0;Y<p.length;++Y){if(E!=L[l].sub[p[Y]].type){d.push(p[Y])}else{if(K!=L[l].sub[p[Y]].upgradeType){d.push(p[Y])}}}d.sort(function(ac,j){return ac-j})}if(C){var F=d.indexOf(C);if(F!=-1){d.splice(d.indexOf(C),0,"u")}}M=d.join(":").replace(/^0:/,"")}this._bonusesBtn.selectedBonus=M;var I=this._bonusesBtn.selectedBonus.split(":");var Q=WH.bonusesGetDefaultAdjustmentBonus.call(this,I);if(Q!=null){var O=false;for(var Y in I){var s=I[Y];if(1372<=s&&s<=1672){O=true}}if(!O){I.push(Q);this._bonusesBtn.selectedBonus=I.join(":")}}var u=I.indexOf("u");if(u!=-1){I.splice(u,1)}var r=[];for(var Y=0;Y<this._bonusesBtn.menu.length;Y++){var v=this._bonusesBtn.menu[Y][MENU_IDX_NAME];if(v&&r.indexOf(v)<0){r.push(v)}}I.sort(function(ac,j){return(r.indexOf(ac)<0?1:-1)-(r.indexOf(j)<0?1:-1)});$(this._bonusesBtn).html("");var o=WH.bonusesBtnGetContextBonusId(I);WH.arrayWalk(this._bonusesBtn.menu,function(ac){ac.checked=ac[MENU_IDX_NAME]==o;var j=Menu.getSubmenu(ac);if(j){WH.arrayWalk(j,function(ad){if(ad[MENU_IDX_NAME]){ad.checked=ac.checked&&I.indexOf(ad[MENU_IDX_NAME])!=-1;if(ad.$a){ad[MENU_IDX_OPT]=null;Menu.updateItem(ad)}}})}});var aa=Menu.findItem(this._bonusesBtn.menu,[o]);if(aa){var T=Menu.getSubmenu(aa);if(T){WH.arrayWalk(T,function(ac){if(ac[MENU_IDX_NAME]){var j=I;if(I.indexOf(ac[MENU_IDX_NAME])==-1){j=j.concat([ac[MENU_IDX_NAME]])}j.sort(function(ae,ad){return ae-ad});if(!WH.bonusesBtnIsComboValid(L,o,j)&&I.indexOf(Q)==-1){ac[MENU_IDX_OPT]={"class":"q0"}}else{ac[MENU_IDX_OPT]={}}Menu.updateItem(ac)}})}}var t=(aa&&aa[MENU_IDX_LABEL])||WH.getItemBonusName.call(this,o,z[A]);for(var Y=0;Y<I.length;++Y){if(I[Y]!=o&&I[Y]!=Q){t+=" + "+WH.getItemBonusName.call(this,I[Y],z[A],o)}}$(this._bonusesBtn).append(t);var q=0;if(WH.isSet("g_itembonuses")&&g_items&&g_items[A]){for(var Y in I){var n=I[Y];if(g_itembonuses[n]){for(var X=0;X<g_itembonuses[n].length;++X){var B=g_itembonuses[n][X];if(B[0]==7&&g_items[A].appearances&&g_items[A].appearances[B[1]]){q=g_items[A].appearances[B[1]][0];break}}}}}var R=$("#e8c7e052e3e0");if(R.length>0){var k=R.get(0).attributes.onclick.value;var g=new RegExp("\\(this, "+A+", \\[[^\\]]*?],");if(g.test(k)){var N=[];for(var f in I){var h=I[f];if(h==0){N.push(h);continue}var V=WH.isSet("g_itembonuses")&&g_itembonuses[h]?g_itembonuses[h]:[];for(var w in V){if(!V.hasOwnProperty(w)){continue}var ab=V[w][0];var H=V[w][1];if(WH.inArray([1,2,6,14],ab)!=-1){if(ab==2&&WH.inArray([61,62,63,64,66],H)!=-1){continue}N.push(h)}}}R.get(0).attributes.onclick.value=k.replace(g,"(this, "+A+", ["+N.join(",")+"],")}}var Z=$("#ic"+A);if(Z.length>0&&g_items){var U=g_items.getIcon(A,I);if(U){Z[0].removeChild(Z[0].firstChild);Z[0].appendChild(Icon.create(U,2))}}var a=$("#dsgndslgn464d");if(a.length>0){var m=a[0].attributes.onclick.value;if(!a[0]._defaultDisplayId){var g=new RegExp('"displayId":(\\d+),',"g");var D=g.exec(m);if(D){a[0]._defaultDisplayId=D[1]}}if(!q&&a[0]._defaultDisplayId){q=a[0]._defaultDisplayId}if(q){a[0].attributes.onclick.value=m.replace(/"displayId":\d+/,'"displayId":'+q)}}if(window.history){var G=this._bonusesBtn.selectedBonus.replace(/u:/,"");if(location.pathname.indexOf("&bonus")!=-1){window.history.replaceState({},"",location.pathname.replace(/&bonus=\d+(:\d+)*/,"&bonus="+G)+location.hash)}else{if(!location.hash){window.history.replaceState({},"",location.pathname+"&bonus="+G)}else{window.history.replaceState({},"",location.pathname+"&bonus="+G+location.hash)}}}WH.updateItemStringLink.call(this);if(!W&&z[A]["tooltip_"+Locale.getName()]){var c=WH.ge("sl"+A);c.innerHTML="";this.slider=null;var S=WH.enhanceTooltip.call(this,A,true,true,c,null,this._knownSpells,WH.ge("ks"+A),this._selectedUpgrade,null,null,true,null,null,this._bonusesBtn.selectedBonus);WH.updateTooltip.call(this,S)}};WH.updateItemStringLink=function(){var a=WH.getDataSource();var k=WH.isSet("g_pageInfo")?g_pageInfo.typeId:null;if(a[k]){var n="";var b=[];if(this._bonusesBtn&&this._bonusesBtn.selectedBonus){n=this._bonusesBtn.selectedBonus.replace(/u:/,"");b=n.split(":")}var h=(typeof this._selectedUpgrade=="number")?this._selectedUpgrade:0;var p=(a[k].upgradeData.length>0)?a[k].upgradeData[h].id:"";var s=this._selectedLevel?this._selectedLevel:WH.maxLevel;var d=this._knowledgeLevel?this._knowledgeLevel:0;var o=(this._classSpecBtn&&this._classSpecBtn.selectedSpec)?this._classSpecBtn.selectedSpec:"";var g=0;var j="";if(p){g|=4;j=(j?":":"")+p}else{if(b.length&&g_itembonuses){bonus_check_block:for(var l=0,e;e=b[l];l++){if(!g_itembonuses[e]){continue}for(var c=0,q;q=g_itembonuses[e][c];c++){if(q[0]==11||q[0]==13){g|=512;j=(j?":":"")+s;break bonus_check_block}}}}}if(d){g|=8388608;j=(j?":":"")+(d+1)}var r=""+(g?g:"")+"::"+(b.length?b.length+":":"")+n+":"+j;var m=WH.ge("open-links-button");if(m){var f={type:3,typeId:k,linkColor:"ff"+WH.Wow.Item.getQualityColor(a[k].quality,true).replace(/^#/,""),linkId:"item:"+k+"::::::::"+s+":"+o+":"+r,linkName:a[k]["name_"+Locale.getName()],bonuses:b,slot:a[k].slot};if(s!=WH.maxLevel){f.lvl=s}if(o){f.spec=o}if(sliderControl=WH.ge("sl"+k)){f.dropLevel=$(sliderControl).find("input").val()}m.onclick=WH.Links.show.bind(WH.Links,m,f)}}};WH.upgradeItemTooltip=function(d,j){var c=WH.getDataSource();var g=g_pageInfo.typeId;if(c[g]){var e=$("#"+d.id+" > input");var a=null;if(typeof j!="number"){e.each(function(k,l){if(l.id.indexOf(j)!=-1){a=l;return false}})}else{a=e.get(j-1)}var h=a.checked;e.each(function(k,l){l.checked=false});a.checked=h;if(!h){j=null}this._selectedUpgrade=j;WH.updateItemStringLink.call(this);if(c[g]["tooltip_"+Locale.getName()]){var f=this._bonusesBtn&&this._bonusesBtn.selectedBonus?this._bonusesBtn.selectedBonus:null;var b=WH.enhanceTooltip.call(this,g,true,true,false,null,this._knownSpells,WH.ge("ks"+g),j,null,null,true,null,null,f);WH.updateTooltip.call(this,b)}}};WH.updateTooltip=function(a){if(this.classList.contains("partial-sub-tooltip")){this.innerHTML=WH.Tooltip.evalFormulas(a);return}this.innerHTML="<table><tr><td>"+WH.Tooltip.evalFormulas(a)+'</td><th style="background-position: top right"></th></tr><tr><th style="background-position: bottom left"></th><th style="background-position: bottom right"></th></tr></table>';WH.Tooltip.fixSafe(this,1,1)};WH.staticTooltipLevelClick=function(b,c,k,n){while(b.className.indexOf("tooltip")==-1){b=b.parentNode}var e=b.innerHTML;var l=e.match(/<!--i?\?(\d+):(\d+):(\d+):(\d+)/);if(!l&&WH.isClassicTree()){l=e.match(/<!--ppl(\d+):(\d+):(\d+):(\d+):(\d+)/);if(l){l=[null,l[1],l[2],WH.maxLevel,0]}}if(!l){return}var h=parseInt(l[1]),a=parseInt(l[2]),j=parseInt(l[3]),f=parseInt(l[4]);if(a>=j){return}if(!c){c=prompt(WH.sprintf(LANG.prompt_ratinglevel,a,j),f)}c=parseInt(c);if(isNaN(c)){return}if(c==f||c<a||c>j){return}b._selectedLevel=c;var d=WH.getDataSource();l=(WH.setTooltipLevel.bind(b,d[h][(n?"buff_":"tooltip_")+Locale.getName()],c,n))();var g=b._bonusesBtn&&b._bonusesBtn.selectedBonus?b._bonusesBtn.selectedBonus:null;var m=b._selectedUpgrade?b._selectedUpgrade:0;l=WH.enhanceTooltip.call(b,l,true,null,null,null,null,null,m,null,null,null,null,null,g);WH.updateTooltip.call(b,l);if(b.slider&&!k){Slider.setValue(b.slider,c)}if(!n){(WH.tooltipSpellsChange.bind(b))()}};WH.staticTooltipKnowledgeLevelClick=function(h,g,e){while(h.className.indexOf("tooltip")==-1){h=h.parentNode}var c=h.innerHTML;if(!g){WH.Tooltip.hide();g=prompt(WH.sprintf(LANG.prompt_ratinglevel,0,g_artifact_knowledge_max_level),h._knowledgeLevel?h._knowledgeLevel:0)}g=parseInt(g);if(isNaN(g)){return}if(g<0||g>g_artifact_knowledge_max_level){return}h._knowledgeLevel=g;if(window.history){var b=g?"&artk="+g:"";if(location.pathname.indexOf("&artk=")!=-1){window.history.replaceState({},"",location.pathname.replace(/&artk=\d+/,b)+location.hash)}else{window.history.replaceState({},"",location.pathname+b+location.hash)}}var a=WH.getDataSource();c=(WH.setTooltipLevel.bind(h,a[e]["tooltip_"+Locale.getName()],h._selectedLevel,null))();var f=h._bonusesBtn&&h._bonusesBtn.selectedBonus?h._bonusesBtn.selectedBonus:null;var d=h._selectedUpgrade?h._selectedUpgrade:0;c=WH.enhanceTooltip.call(h,c,true,null,null,null,null,null,d,null,null,null,null,null,f);WH.updateTooltip.call(h,c)};WH.tooltipSliderMove=function(c,b,a){WH.staticTooltipLevelClick(this,a.value,1);if(this.bufftip){WH.staticTooltipLevelClick(this.bufftip,a.value,1,1)}WH.Tooltip.hide()};WH.tooltipSpellsChange=function(){if(!this.modified){return}var c=this.modified[0],a=this.modified[1],b=[];$.each($("input:checked",c),function(d,e){b.push(parseInt(e.dataset.spellId))});$.each($("select option",c),function(e,d){if(d.selected){b.push(parseInt(d.value))}});this.modified[2]=b;this.innerHTML=WH.setTooltipSpells(this.innerHTML,b,a);if(this.bufftip){(WH.tooltipSpellsChange.bind(this.bufftip))()}};WH.tooltipRPPMChange=function(b){var a=$(this).attr("id").match(/\d+$/)[0];b.innerHTML=WH.Tooltip.evalFormulas(b.innerHTML.replace(/<!--rppm-->(\[?)(\d+(?:\.\d+)?)([^<]*)<!--rppm-->/,function(c,f,e,d){return"<!--rppm-->"+f+(b._rppmModBase*(1+parseFloat(b._rppmSpecModList[a].modifiervalue))).toFixed(2)+d+"<!--rppm-->"}))};WH.validateBpet=function(j,d){var a=1,h=25,k=25,b=0,f=4,e=3,l=(1<<10)-1,c=3,g=$.extend({},d);if(j.minlevel){a=j.minlevel}if(j.maxlevel){h=j.maxlevel}if(j.companion){h=a}if(!g.level){g.level=k}g.level=Math.min(Math.max(g.level,a),h);if(j.minquality){b=j.minquality;if(j.untameable){f=b}}if(j.maxquality){f=j.maxquality}if(g.quality==null){g.quality=e}g.quality=Math.min(Math.max(g.quality,b),f);if(j.companion){delete (g.quality)}if(j.breeds>0){l=j.breeds&l}if(!(l&(1<<c-3))){c=Math.floor(3+Math.log(l)/Math.LN2)}if(g.breed&&g.breed>=13){g.breed-=10}if(!g.breed||!(l&(1<<g.breed-3))){g.breed=c}return g};WH.calcBattlePetStats=function(j,c,k,a,d){if(!WH.battlePetBreedStats[c]){c=3}var h=j.health;if(isNaN(h)){h=0}var b=j.power;if(isNaN(b)){b=0}var f=j.speed;if(isNaN(f)){f=0}if(isNaN(k)){k=1}k=Math.min(Math.max(0,k),5);if(isNaN(a)){a=1}a=Math.min(Math.max(1,a),25);var e=WH.battlePetBreedStats[c];var g=1+(k/10);h=((h+e[0])*5*a*g)+100;b=(b+e[1])*a*g;f=(f+e[2])*a*g;if(d){h=h*5/6;b=b*4/5}return{health:Math.round(h),power:Math.round(b),speed:Math.round(f)}};WH.battlePetBreedStats={3:[0.5,0.5,0.5],4:[0,2,0],5:[0,0,2],6:[2,0,0],7:[0.9,0.9,0],8:[0,0.9,0.9],9:[0.9,0,0.9],10:[0.4,0.9,0.4],11:[0.4,0.4,0.9],12:[0.9,0.4,0.4]};WH.battlePetAbilityLevels=[1,2,4,10,15,20];WH.Tooltip={showingTooltip:false,create:function(j,l){var g=WH.ce("div"),n=WH.ce("table"),c=WH.ce("tbody"),f=WH.ce("tr"),b=WH.ce("tr"),a=WH.ce("td"),m=WH.ce("th"),k=WH.ce("th"),h=WH.ce("th");g.className="wowhead-tooltip";m.style.backgroundPosition="top right";k.style.backgroundPosition="bottom left";h.style.backgroundPosition="bottom right";if(j){a.innerHTML=WH.Tooltip.evalFormulas(j)}WH.ae(f,a);WH.ae(f,m);WH.ae(c,f);WH.ae(b,k);WH.ae(b,h);WH.ae(c,b);WH.ae(n,c);if(!l){WH.Tooltip.icon=WH.ce("p");WH.Tooltip.icon.style.visibility="hidden";WH.ae(WH.Tooltip.icon,WH.ce("div"));WH.ae(g,WH.Tooltip.icon)}WH.ae(g,n);if(!l){var e=WH.ce("div");e.className="wowhead-tooltip-powered";WH.ae(g,e);WH.Tooltip.logo=e}return g},getMultiPartHtml:function(b,a){return"<table><tr><td>"+b+"</td></tr></table><table><tr><td>"+a+"</td></tr></table>"},evalFormulas:function(e){if(typeof e!=="string"){return e}e=e.replace(/<span class="wh-tooltip-formula" style="display:none">(\[[\w\W]*?\])<\/span>\d*/g,"$1");var a=0;var d=0;var c="";var g=0;for(var f=0;f<e.length;f++){var b=e.substr(f,1);switch(b){case"[":a++;d=0;c="";break;case"]":a--;if(a<0){a=0}d=0;c="";break;case"(":if(a>0){break}c+=b;d++;break;case")":if(a>0){break}if(d>0){c+=b;d--}break;default:if(a==0&&d>0){c+=b}}if(a==0&&d==0&&c){g=f-c.length+1;if(/[^ ()0-9\+\*\/\.-]/.test(c.replace(/<!--[\w\W]*?-->/g,"").replace(/\b(floor|ceil|abs)\b/gi,""))){c="";continue}if(/^\([0-9\.]*\)$/.test(c)){c="";continue}if(!/<!--[\w\W]*?-->/g.test(c)){c="";continue}e=e.substr(0,g)+"["+e.substring(g,f+1)+"]"+e.substr(f+1);f+=2;c=""}}e=e.replace(/\[([^\]]+)\]/g,function(j,l){var h;l=l.replace(/<!--[\w\W]*?-->/g,"");l=l.replace(/\b(floor|ceil|abs)\b/gi,"Math.$1");try{h=Function('"use strict";return ('+l+")")()}catch(k){h=undefined}if(typeof h==="undefined"){return j}return'<span class="wh-tooltip-formula" style="display:none">'+j+"</span>"+Math.abs(h)});return e},fix:function(k,b,d){var j=WH.gE(k,"table")[0],f=WH.gE(j,"td")[0],g=f.childNodes;k.className=WH.trim(k.className.replace("tooltip-slider",""));if(g.length>=2&&g[0].nodeName=="TABLE"&&g[1].nodeName=="TABLE"){g[0].style.whiteSpace="nowrap";var e=parseInt(k.style.width);if(!k.slider||!e){if(g[1].offsetWidth==0){e=320}else{if(g[1].offsetWidth>300){e=Math.max(300,g[0].offsetWidth)+20}else{e=Math.max(g[0].offsetWidth,g[1].offsetWidth)+20}}}for(var h=2;h<g.length;h++){if(g[h].nodeName=="BLOCKQUOTE"){e=Math.max(e,g[h].offsetWidth+20)}}e=Math.min(320,e);if(e>20){if(k.slider){Slider.setSize(k.slider,e-6);k.className+=" tooltip-slider"}k.className+=" wowhead-tooltip-width-restriction wowhead-tooltip-width-"+e;k.style.width=e+"px";g[0].style.width=g[1].style.width="100%";if(!b&&k.offsetHeight>document.body.clientHeight){j.className="shrink"}}}else{if(g.length>=1&&k.slider){var a=g[0].nodeName=="TABLE";if(a){g[0].style.whiteSpace="nowrap"}var e=parseInt(k.style.width);if(!e&&a){e=g[0].offsetWidth+20}else{e=j.offsetWidth+20}e=Math.min(320,e);if(e>20){k.style.width=e+"px";if(a){g[0].style.width="100%"}if(k.slider){Slider.setSize(k.slider,e-6);k.className+=" tooltip-slider"}if(!b&&k.offsetHeight>document.body.clientHeight){j.className="shrink"}}}}if(d){WH.Tooltip.setTooltipVisibility(k,true)}},fixSafe:function(c,b,a){WH.Tooltip.fix(c,b,a)},attachImage:function(d,e,j,k){if(typeof k=="undefined"){k=""}if(typeof jQuery!="undefined"){jQuery(d.parentNode).children(".image"+k).remove()}else{var l=new RegExp("\\bimage"+k+"\\b");for(var h=0;h<d.parentNode.childNodes.length;h++){if(l.test(d.parentNode.childNodes[h].className)){d.parentNode.removeChild(d.parentNode.childNodes[h]);h--}}}var f=typeof e;if(f=="number"){var g=WH.getDataSource(),b=e;if(g[b]&&g[b]["image_"+Locale.getName()+k]){e=g[b]["image_"+Locale.getName()+k]}else{return}}else{if(f!="string"||!e){return}}var a=WH.ce("div");a.className="image"+k+(j?" "+j:"");a.style.backgroundImage="url("+e+")";if(typeof jQuery!="undefined"){jQuery(d).after(a)}else{d.parentNode.insertBefore(a,d.nextSibling)}},append:function(e,b,a,d){var e=WH.ge(e);var f=WH.Tooltip.create(b,a);if(d){var c=WH.ce("p");c.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/medium/"+d.toLowerCase()+".jpg)";WH.ae(c,WH.ce("div"));WH.ae(f,c)}WH.ae(e,f);WH.Tooltip.fixSafe(f,1,1)},reset:function(){if(WH.Tooltip.tooltip){WH.Tooltip.tooltip.parentNode.removeChild(WH.Tooltip.tooltip);WH.Tooltip.tooltip=null}if(WH.Tooltip.tooltip2){WH.Tooltip.tooltip2.parentNode.removeChild(WH.Tooltip.tooltip2);WH.Tooltip.tooltip2=null}},prepare:function(c,e){var a=e===true?"fixed":"absolute";if(WH.Tooltip.tooltip){WH.Tooltip.tooltip.style.position=a;WH.Tooltip.tooltip2.style.position=a;return}var d=(typeof c!="undefined")?c:document.body;var b=WH.Tooltip.create();b.style.position=a;b.style.left=b.style.top="-2323px";WH.ae(d,b);WH.Tooltip.tooltip=b;WH.Tooltip.tooltipTable=WH.gE(b,"table")[0];WH.Tooltip.tooltipTd=WH.gE(b,"td")[0];var b=WH.Tooltip.create(null,true);b.style.position=a;b.style.left=b.style.top="-2323px";WH.ae(d,b);WH.Tooltip.tooltip2=b;WH.Tooltip.tooltipTable2=WH.gE(b,"table")[0];WH.Tooltip.tooltipTd2=WH.gE(b,"td")[0]},prepareScreen:function(){if(WH.Tooltip.screen){WH.Tooltip.screen.style.display="block"}else{WH.Tooltip.screen=WH.ce("div",{id:"wowhead-tooltip-screen",className:"wowhead-tooltip-screen"});WH.Tooltip.screenCloser=WH.ce("a",{id:"wowhead-tooltip-screen-close",className:"wowhead-tooltip-screen-close",onclick:$WowheadPower.clearTouchTooltip});WH.Tooltip.screenInnerWrapper=WH.ce("div",{id:"wowhead-tooltip-screen-inner-wrapper",className:"wowhead-tooltip-screen-inner-wrapper"});WH.Tooltip.screenInner=WH.ce("div",{id:"wowhead-tooltip-screen-inner",className:"wowhead-tooltip-screen-inner"});WH.Tooltip.screenInnerBox=WH.ce("div",{id:"wowhead-tooltip-screen-inner-box",className:"wowhead-tooltip-screen-inner-box"});WH.Tooltip.screenCaption=WH.ce("div",{id:"wowhead-tooltip-screen-caption",className:"wowhead-tooltip-screen-caption"});WH.ae(WH.Tooltip.screen,WH.Tooltip.screenCloser);WH.ae(WH.Tooltip.screenInner,WH.Tooltip.screenInnerBox);WH.ae(WH.Tooltip.screenInnerWrapper,WH.Tooltip.screenInner);WH.ae(WH.Tooltip.screen,WH.Tooltip.screenInnerWrapper);WH.ae(WH.Tooltip.screen,WH.Tooltip.screenCaption);WH.ae(document.body,WH.Tooltip.screen)}WH.Tooltip.mobileTooltipShown=true;WH.Tooltip.setupIScroll()},destroyIScroll:function(){if(WH.Tooltip.iScroll){WH.Tooltip.iScroll.destroy();WH.Tooltip.iScroll=null}},setupIScroll:function(){if(!WH.Tooltip.mobileScrollSetUp){var a=function(b){if(WH.Tooltip.mobileTooltipShown){if(!document.getElementById("wowhead-tooltip-screen-inner").contains(b.target)){b.preventDefault()}}};WH.aE(document.body,"touchmove",a);WH.aE(document.body,"mousewheel",a);WH.Tooltip.mobileScrollSetUp=true}if(typeof IScroll!="function"){return}setTimeout(function(){WH.Tooltip.destroyIScroll();WH.Tooltip.iScroll=new IScroll(WH.Tooltip.screenInnerWrapper,{mouseWheel:true,tap:true})},1)},setTooltipVisibility:function(a,b){if(b){a.setAttribute("data-visible","yes");a.style.visibility="visible"}else{a.setAttribute("data-visible","no");a.style.visibility="hidden"}},set:function(g,d,f,c){var b=WH.Tooltip.tooltip;b.style.width="550px";b.style.left="-2323px";b.style.top="-2323px";WH.Tooltip.tooltip.className="wowhead-tooltip";if(g.nodeName){WH.ee(WH.Tooltip.tooltipTd);WH.ae(WH.Tooltip.tooltipTd,g)}else{WH.Tooltip.tooltipTd.innerHTML=WH.Tooltip.evalFormulas(g)}b.style.display="";WH.Tooltip.setTooltipVisibility(b,true);WH.Tooltip.fix(b,0,0);if(d){WH.Tooltip.showSecondary=true;var b=WH.Tooltip.tooltip2;b.style.width="550px";b.style.left="-2323px";b.style.top="-2323px";if(d.nodeName){WH.ee(WH.Tooltip.tooltipTd2);WH.ae(WH.Tooltip.tooltipTd2,d)}else{WH.Tooltip.tooltipTd2.innerHTML=WH.Tooltip.evalFormulas(d)}b.style.display="";WH.Tooltip.fix(b,0,0)}else{WH.Tooltip.showSecondary=false}var a=null;if(typeof Platform!=="undefined"){a=Platform.isTouch()}else{if(typeof WH!=="undefined"){a=WH.isTouch()}}if(a){var e=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTd2:WH.Tooltip.tooltipTd;var h=WH.ce("a");h.href="javascript:;";h.className="wowhead-touch-tooltip-closer";h.onclick=$WowheadPower.clearTouchTooltip;WH.ae(e,h)}WH.Tooltip.tooltipTable.style.display=(g=="")?"none":"";WH.Tooltip.attachImage(WH.Tooltip.tooltipTable,f,c);WH.Tooltip.generateEvent("show")},moveTests:[[null,null],[null,false],[false,null],[false,false]],move:function(o,n,e,q,d,b){if(!WH.Tooltip.tooltipTable){return}var r=WH.Tooltip.tooltip,j=WH.Tooltip.tooltipTable.offsetWidth,c=WH.Tooltip.tooltipTable.offsetHeight,l=WH.Tooltip.tooltip2,g=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetWidth:0,a=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetHeight:0,p;r.style.width=(j==0)?"auto":(j+"px");l.style.width=g+"px";var m,f;for(var h=0,k=WH.Tooltip.moveTests.length;h<k;++h){p=WH.Tooltip.moveTests[h];m=WH.Tooltip.moveTest(o,n,e,q,d,b,p[0],p[1]);if(WH.WAS&&!WH.WAS.intersect(m)){f=true;break}else{if(!WH.WAS){break}}}if(WH.WAS&&!f){WH.WAS.intersect(m,true)}r.style.left=m.l+"px";r.style.top=m.t+"px";WH.Tooltip.setTooltipVisibility(r,true);if(WH.Tooltip.showSecondary){l.style.left=m.l+j+"px";l.style.top=m.t+"px";WH.Tooltip.setTooltipVisibility(l,true)}WH.Tooltip.generateEvent("move")},moveTest:function(d,j,o,k,b,a,l,h){var w=d,n=j,e=WH.Tooltip.tooltip,p=WH.Tooltip.tooltipTable.offsetWidth,v=WH.Tooltip.tooltipTable.offsetHeight,m=WH.Tooltip.tooltip2,q=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetWidth:0,g=WH.Tooltip.showSecondary?WH.Tooltip.tooltipTable2.offsetHeight:0,f=WH.getWindowSize(),c=WH.getScroll(),u=c.x,t=c.y,s=c.x+f.w,r=c.y+f.h;if(e.style.position==="fixed"){d-=c.x;j-=c.y;w-=d;n-=j;c={x:0,y:0};u=t=0;s=f.w;r=f.h}if(l==null){l=(d+o+p+q<=s)}if(h==null){h=(j-Math.max(v,g)>=t)}if(l){d+=o+b}else{d=Math.max(d-(p+q),u)-b}if(h){j-=Math.max(v,g)+a}else{j+=k+a}if(d<u){d=u}else{if(d+p+q>s){d=s-(p+q)}}if(j<t){j=t}else{if(j+Math.max(v,g)>r){j=Math.max(c.y,r-Math.max(v,g))}}if(WH.Tooltip.iconVisible){if(w>=d-48&&w<=d&&n>=j-4&&n<=j+48){j-=48-(n-j)}}return WH.createRect(d,j,p,v)},show:function(g,j,c,a,b,d,e,h,f){if(WH.Tooltip.disabled){return}if(!c||c<1){c=1}if(!a||a<1){a=1}if(b){j='<span class="'+b+'">'+j+"</span>"}let offset=WH.getOffset(g);WH.Tooltip.prepare(undefined,f);WH.Tooltip.set(j,d,e,h);WH.Tooltip.move(offset.left,offset.top,g.offsetWidth,g.offsetHeight,c,a)},showAtCursor:function(g,k,c,a,b,d,f,j){if(WH.Tooltip.disabled){return}if(!c||c<10){c=10}if(!a||a<10){a=10}if(b){k='<span class="'+b+'">'+k+"</span>";if(d){d='<span class="'+b+'">'+d+"</span>"}}g=WH.normalizeEvent(g);var h=WH.getCursorPos(g);WH.Tooltip.prepare(undefined,g.target?WH.isElementFixedPosition(g.target):false);WH.Tooltip.set(k,d,f,j);WH.Tooltip.move(h.x,h.y,0,0,c,a)},showAtXY:function(j,g,f,b,a,c,d,h,e){if(WH.Tooltip.disabled){return}WH.Tooltip.prepare(undefined,e);WH.Tooltip.set(j,c,d,h);WH.Tooltip.move(g,f,0,0,b,a)},showInScreen:function(e,j,b,c,d,h,f){$WowheadPower.clearTouchTooltip(true);if(WH.Tooltip.disabled){return}if(b){j='<span class="'+b+'">'+j+"</span>"}WH.Tooltip.prepareScreen();WH.ee(WH.Tooltip.screenCaption);var g=WH.ce("a",{innerHTML:WH.isRemote()?"Tap Link":LANG.tooltip_taplink,onclick:(function(l,a){l.setAttribute("data-disable-wowhead-tooltip","true");if(l.fireEvent){l.fireEvent("on"+a)}else{if(typeof MouseEvent=="function"){l.dispatchEvent(new MouseEvent(a,{bubbles:true,cancelable:true}))}else{var m=document.createEvent("Events");m.initEvent(a,true,true);l.dispatchEvent(m)}}if(l){l.removeAttribute("data-disable-wowhead-tooltip")}$WowheadPower.clearTouchTooltip()}).bind(null,e,"click")});var k=WH.ce("i",{className:"fa fa-hand-o-up"});WH.aef(g,k);WH.ae(WH.Tooltip.screenCaption,g);$WowheadPower.setParent(WH.Tooltip.screenInnerBox);WH.Tooltip.setIcon(f);WH.Tooltip.set(j,c,d,h);WH.Tooltip.move()},cursorUpdate:function(b,a,d){if(WH.Tooltip.disabled||!WH.Tooltip.tooltip){return}b=WH.normalizeEvent(b);if(!a||a<10){a=10}if(!d||d<10){d=10}var c=WH.getCursorPos(b);WH.Tooltip.move(c.x,c.y,0,0,a,d)},hide:function(){if(WH.Tooltip.tooltip){WH.Tooltip.showingTooltip=false;WH.Tooltip.tooltip.style.display="none";WH.Tooltip.setTooltipVisibility(WH.Tooltip.tooltip,false);WH.Tooltip.tooltipTable.className="";WH.Tooltip.setIcon(null);if(WH.WAS){WH.WAS.restoreHidden()}WH.Tooltip.generateEvent("hide")}if(WH.Tooltip.tooltip2){WH.Tooltip.tooltip2.style.display="none";WH.Tooltip.setTooltipVisibility(WH.Tooltip.tooltip2,false);WH.Tooltip.tooltipTable2.className=""}},setIcon:function(a,b){WH.Tooltip.prepare(undefined,b);if(a){WH.Tooltip.icon.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/medium/"+a.toLowerCase()+".jpg)";WH.Tooltip.icon.style.visibility="visible"}else{WH.Tooltip.icon.style.backgroundImage="none";WH.Tooltip.icon.style.visibility="hidden"}WH.Tooltip.iconVisible=a?1:0},generateEvent:function(a){if(!WH.Tooltip.tooltip){return}try{WH.Tooltip.tooltip.dispatchEvent(new Event(a))}catch(c){try{var b=document.createEvent("Event");b.initEvent(a,true,true);WH.Tooltip.tooltip.dispatchEvent(b)}catch(c){void (0)}}},addTooltipText:function(a,c,b){if(!a){WH.error("Tooltip text addition element not found!",a,c,b);return}a._fixTooltip=(function(f,l,h,e){var g=/<\/table>\s*$/;var k=typeof h==="function"?h():h;var j=h?' class="'+k+'"':"";var d=typeof l==="function"?l():l;if(g.test(e)){return e.replace(g,'<tr><td colspan="2"><div'+j+' style="margin-top:10px">'+d+"</div></td></tr></table>")}else{return e+"<div"+j+' style="margin-top:10px">'+d+"</div>"}}).bind(null,a,c,b)},simple:function(c,j,f,a,g,e,h){if(c instanceof jQuery){for(var d=0,b;b=c[d];d++){WH.Tooltip.simple(b,j,f,a,g,e,h)}return}if(typeof j==="string"){if(typeof e==="undefined"&&j.length<30){e=true}if(e){j='<div class="no-wrap">'+j+"</div>"}if(h&&!isNaN(h)){j='<div style="max-width:'+h+'px">'+j+"</div>"}}if(a){if(g){c.onmouseover=function(k){WH.Tooltip.show(c,typeof j==="function"?j.call(this,k):j,false,false,f);k.stopPropagation()}}else{c.onmouseover=function(k){WH.Tooltip.show(c,typeof j==="function"?j.call(this,k):j,false,false,f)}}}else{if(g){c.onmouseover=function(k){WH.Tooltip.showAtCursor(k,typeof j==="function"?j.call(this,k):j,false,false,f);k.stopPropagation()}}else{c.onmouseover=function(k){WH.Tooltip.showAtCursor(k,typeof j==="function"?j.call(this,k):j,false,false,f)}}c.onmousemove=WH.Tooltip.cursorUpdate}c.onmouseout=WH.Tooltip.hide},simpleNonTouch:function(a,d,b,c,e){if(!Platform.isTouch()){WH.Tooltip.simple(a,d,b,c,false,e)}},simpleOverride:function(e,f,c,a,h,g,j,d,k,b,l){e.overrideTooltip={html:f,htmlGenerator:c,spanClass:a,icon:h,html2:g,html2Generator:j,image:d,imageClass:k,map:b,spellData:l}}};WH.createButton=function(l,d,o){var j="btn btn-site";var h="";var e="";var c="";var n="";var f=[];var m=[];if(!o){o={}}if(!o["no-margin"]){m.push("margin-left:5px")}if(typeof d!="string"||d===""){d="javascript:;"}if(o["new-window"]){h=' target="_blank"'}if(typeof o.id=="string"){e=' id="'+o.id+'"'}if(typeof o.size!="undefined"){switch(o.size){case"small":case"large":f.push("btn-"+o.size);break}}else{f.push("btn-small")}if(typeof o["class"]=="string"){f.push(o["class"])}if(typeof o.type=="string"){switch(o.type){case"default":case"gray":j="btn";break;default:j="btn btn-"+o.type}}if(o.disabled){f.push("btn-disabled");d="javascript:;"}if(f.length){j+=" "+f.join(" ")}if(j){j=' class="'+j+'"'}if(!(typeof o["float"]!="undefined"&&!o["float"])){m.push("float:right")}if(typeof o.style=="string"){m.push(o.style)}if(m.length){c=' style="'+m.join(";")+'"'}var g='<a href="'+d+'"'+h+e+j+c+">"+(l||"")+"</a>";var b=WH.ce("div");b.innerHTML=g;var k=b.childNodes[0];if(typeof o.click=="function"&&!o.disabled){k.onclick=o.click}if(typeof o.tooltip!="undefined"){if(o.tooltip!==false){k.setAttribute("data-whattach","true")}if(o.tooltip===false){k.rel="np"}else{if(typeof o.tooltip=="string"){WH.Tooltip.simple(k,o.tooltip,null,true)}else{if(typeof o.tooltip=="object"&&o.tooltip["text"]){WH.Tooltip.simple(k,o.tooltip["text"],o.tooltip["class"],true)}}}}return k};if(WH.isSet("$WowheadPower")){$WowheadPower.init()};

}
/*
     FILE ARCHIVED ON 01:06:48 Mar 11, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 03:06:43 Oct 09, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 217.229
  exclusion.robots: 0.073
  exclusion.robots.policy: 0.063
  cdx.remote: 0.059
  esindex: 0.01
  LoadShardBlock: 155.323 (3)
  PetaboxLoader3.datanode: 260.74 (5)
  load_resource: 284.808 (2)
  PetaboxLoader3.resolve: 125.946 (2)
*/